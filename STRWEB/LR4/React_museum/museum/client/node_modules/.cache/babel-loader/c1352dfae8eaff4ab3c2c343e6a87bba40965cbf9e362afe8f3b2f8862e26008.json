{"ast":null,"code":"// ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ñ… Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹\n\n// 1. XMLHttpRequest Ñ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ¾Ð¼\nexport const uploadFileWithProgress = (file, onProgress, onComplete) => {\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n    xhr.upload.addEventListener('progress', e => {\n      if (e.lengthComputable && onProgress) {\n        const progress = Math.round(e.loaded * 100 / e.total);\n        onProgress(progress);\n      }\n    });\n    xhr.addEventListener('load', () => {\n      if (xhr.status === 200) {\n        try {\n          const response = JSON.parse(xhr.responseText);\n          if (onComplete) onComplete(response);\n          resolve(response);\n        } catch (error) {\n          reject(new Error('Invalid JSON response'));\n        }\n      } else {\n        reject(new Error(`Upload failed: ${xhr.status}`));\n      }\n    });\n    xhr.addEventListener('error', () => {\n      reject(new Error('Network error during upload'));\n    });\n    xhr.addEventListener('abort', () => {\n      reject(new Error('Upload aborted'));\n    });\n    const formData = new FormData();\n    formData.append('file', file);\n    formData.append('uploadTime', new Date().toISOString());\n    xhr.open('POST', 'http://localhost:5000/api/upload');\n    xhr.setRequestHeader('Accept', 'application/json');\n    xhr.send(formData);\n  });\n};\n\n// 2. setTimeout Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸ÐµÐ¼ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ\nexport const createTimerWithPersistence = (name, duration, onTick, onComplete) => {\n  let remaining = duration;\n  let timerId = null;\n\n  // Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ð¾Ð³Ð¾ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ\n  const savedTime = localStorage.getItem(`timer_${name}`);\n  if (savedTime) {\n    try {\n      const savedData = JSON.parse(savedTime);\n      const elapsed = Date.now() - savedData.timestamp;\n      remaining = Math.max(0, savedData.remaining - Math.floor(elapsed / 1000));\n    } catch (error) {\n      console.error('Error loading timer state:', error);\n    }\n  }\n  const saveState = () => {\n    localStorage.setItem(`timer_${name}`, JSON.stringify({\n      remaining,\n      timestamp: Date.now(),\n      name,\n      totalDuration: duration\n    }));\n  };\n  const tick = () => {\n    if (remaining > 0) {\n      remaining--;\n      saveState();\n      if (onTick) {\n        onTick(remaining);\n      }\n\n      // Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸\n      const hours = Math.floor(remaining / 3600);\n      const minutes = Math.floor(remaining % 3600 / 60);\n      const seconds = remaining % 60;\n      console.log(`Ð¢Ð°Ð¹Ð¼ÐµÑ€ \"${name}\": ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`);\n    } else {\n      clearInterval(timerId);\n      localStorage.removeItem(`timer_${name}`);\n      if (onComplete) onComplete();\n    }\n  };\n  timerId = setInterval(tick, 1000);\n\n  // ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ðµ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ\n  saveState();\n  return {\n    stop: () => {\n      if (timerId) {\n        clearInterval(timerId);\n        saveState();\n      }\n    },\n    reset: () => {\n      if (timerId) clearInterval(timerId);\n      remaining = duration;\n      saveState();\n      timerId = setInterval(tick, 1000);\n    },\n    getRemaining: () => remaining,\n    getName: () => name,\n    isRunning: () => timerId !== null\n  };\n};\n\n// 3. Promise Ñ†ÐµÐ¿Ð¾Ñ‡ÐºÐ° Ð´Ð»Ñ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ\nexport const bookTourWithValidation = async (tourId, visitorCount, paymentMethod) => {\n  console.log('ðŸš€ ÐÐ°Ñ‡Ð°Ð»Ð¾ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ‚ÑƒÑ€Ð°...');\n  try {\n    // Ð¨Ð°Ð³ 1: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸\n    const availability = await new Promise((resolve, reject) => {\n      setTimeout(() => {\n        const isAvailable = Math.random() > 0.1;\n        if (isAvailable) {\n          resolve({\n            available: true,\n            message: 'ÐœÐµÑÑ‚Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹',\n            tourId,\n            maxCapacity: 20\n          });\n        } else {\n          reject(new Error('ÐÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… Ð¼ÐµÑÑ‚ Ð½Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ'));\n        }\n      }, 800);\n    });\n    console.log('âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸:', availability);\n\n    // Ð¨Ð°Ð³ 2: Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…\n    const validation = await new Promise(resolve => {\n      setTimeout(() => {\n        if (visitorCount > 0 && visitorCount <= availability.maxCapacity) {\n          resolve({\n            valid: true,\n            message: 'Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐµÐ½Ñ‹',\n            visitorCount\n          });\n        } else {\n          resolve({\n            valid: false,\n            message: `ÐÐµÐ²ÐµÑ€Ð½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ð¾ÑÐµÑ‚Ð¸Ñ‚ÐµÐ»ÐµÐ¹ (Ð¼Ð°ÐºÑ: ${availability.maxCapacity})`\n          });\n        }\n      }, 600);\n    });\n    if (!validation.valid) {\n      throw new Error(validation.message);\n    }\n    console.log('âœ… Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…:', validation);\n\n    // Ð¨Ð°Ð³ 3: ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°\n    const payment = await new Promise((resolve, reject) => {\n      setTimeout(() => {\n        const isPaymentSuccessful = Math.random() > 0.05;\n        if (isPaymentSuccessful) {\n          resolve({\n            success: true,\n            transactionId: `TXN-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n            amount: visitorCount * 500,\n            currency: 'RUB',\n            method: paymentMethod,\n            timestamp: new Date().toISOString()\n          });\n        } else {\n          reject(new Error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°'));\n        }\n      }, 1500);\n    });\n    console.log('âœ… ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°:', payment);\n\n    // Ð¨Ð°Ð³ 4: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð±Ñ€Ð¾Ð½Ð¸\n    const booking = await new Promise(resolve => {\n      setTimeout(() => {\n        resolve({\n          bookingId: `BOOK-${Date.now()}-${Math.random().toString(36).substr(2, 6).toUpperCase()}`,\n          tourId,\n          visitorCount,\n          totalAmount: payment.amount,\n          bookingDate: new Date().toISOString(),\n          status: 'confirmed',\n          qrCodeUrl: `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=booking-${Date.now()}`\n        });\n      }, 700);\n    });\n    console.log('âœ… Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð±Ñ€Ð¾Ð½Ð¸:', booking);\n\n    // Ð¨Ð°Ð³ 5: ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ\n    await new Promise(resolve => {\n      setTimeout(() => {\n        console.log('ðŸ“§ ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ð½Ð° email');\n        resolve();\n      }, 300);\n    });\n    return {\n      success: true,\n      message: 'Ð‘Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾!',\n      data: {\n        availability,\n        validation,\n        payment,\n        booking\n      },\n      timestamp: new Date().toISOString(),\n      nextSteps: ['ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð²Ð°ÑˆÑƒ Ð¿Ð¾Ñ‡Ñ‚Ñƒ', 'Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚Ðµ QR-ÐºÐ¾Ð´', 'ÐŸÑ€Ð¸Ñ…Ð¾Ð´Ð¸Ñ‚Ðµ Ð·Ð° 15 Ð¼Ð¸Ð½ÑƒÑ‚ Ð´Ð¾ Ð½Ð°Ñ‡Ð°Ð»Ð°']\n    };\n  } catch (error) {\n    console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ:', error);\n\n    // ÐžÑ‚ÐºÐ°Ñ‚ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹\n    await new Promise(resolve => {\n      setTimeout(() => {\n        console.log('ðŸ”„ Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð¾Ñ‚ÐºÐ°Ñ‚ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹...');\n        resolve();\n      }, 500);\n    });\n    return {\n      success: false,\n      error: error.message,\n      timestamp: new Date().toISOString(),\n      recoverySteps: ['ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚ÑŒ Ð¼ÐµÑÑ‚', 'ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð´Ñ€ÑƒÐ³Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ', 'Ð¡Ð²ÑÐ¶Ð¸Ñ‚ÐµÑÑŒ Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹']\n    };\n  }\n};\n\n// 4. ÐŸÐ°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ñ Promise.all\nexport const fetchDashboardData = async () => {\n  console.log('ðŸ“Š Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´Ð°...');\n  try {\n    const [exhibits, visitors, events, weather, stats] = await Promise.all([\n    // Ð­ÐºÑÐ¿Ð¾Ð½Ð°Ñ‚Ñ‹\n    fetch('http://localhost:5000/api/exhibits?limit=5').then(res => res.json()).then(data => ({\n      type: 'exhibits',\n      data: data.exhibits,\n      count: data.total,\n      updated: new Date().toISOString()\n    })).catch(() => ({\n      type: 'exhibits',\n      data: [],\n      count: 0,\n      error: 'Failed to load exhibits'\n    })),\n    // ÐŸÐ¾ÑÐµÑ‚Ð¸Ñ‚ÐµÐ»Ð¸\n    new Promise(resolve => {\n      setTimeout(() => {\n        resolve({\n          type: 'visitors',\n          data: {\n            today: Math.floor(Math.random() * 100) + 50,\n            week: Math.floor(Math.random() * 1000) + 500,\n            month: Math.floor(Math.random() * 5000) + 2000,\n            averageDaily: Math.floor(Math.random() * 150) + 100\n          },\n          trend: 'up',\n          changePercent: 12\n        });\n      }, 600);\n    }),\n    // Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ñ\n    new Promise(resolve => {\n      setTimeout(() => {\n        resolve({\n          type: 'events',\n          data: [{\n            id: 1,\n            name: 'ÐÐ¾Ñ‡Ð½Ð°Ñ ÑÐºÑÐºÑƒÑ€ÑÐ¸Ñ',\n            date: '2024-04-15',\n            seats: 15\n          }, {\n            id: 2,\n            name: 'ÐœÐ°ÑÑ‚ÐµÑ€-ÐºÐ»Ð°ÑÑ',\n            date: '2024-04-20',\n            seats: 10\n          }, {\n            id: 3,\n            name: 'Ð›ÐµÐºÑ†Ð¸Ñ Ð¾Ð± Ð¸ÑÐºÑƒÑÑÑ‚Ð²Ðµ',\n            date: '2024-04-25',\n            seats: 20\n          }],\n          upcoming: 3,\n          totalThisMonth: 12\n        });\n      }, 400);\n    }),\n    // ÐŸÐ¾Ð³Ð¾Ð´Ð°\n    new Promise(resolve => {\n      setTimeout(() => {\n        const conditions = ['â˜€ï¸ Ð¡Ð¾Ð»Ð½ÐµÑ‡Ð½Ð¾', 'â›… ÐžÐ±Ð»Ð°Ñ‡Ð½Ð¾', 'ðŸŒ§ï¸ Ð”Ð¾Ð¶Ð´ÑŒ', 'â„ï¸ Ð¡Ð½ÐµÐ³'];\n        const condition = conditions[Math.floor(Math.random() * conditions.length)];\n        resolve({\n          type: 'weather',\n          data: {\n            temperature: Math.floor(Math.random() * 15) + 15,\n            condition: condition,\n            humidity: Math.floor(Math.random() * 40) + 40,\n            feelsLike: Math.floor(Math.random() * 15) + 15,\n            windSpeed: Math.floor(Math.random() * 10) + 5\n          },\n          forecast: 'Ð¡Ñ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð°Ñ Ð¿Ð¾Ð³Ð¾Ð´Ð°',\n          icon: condition.includes('â˜€ï¸') ? 'sunny' : condition.includes('â›…') ? 'cloudy' : condition.includes('ðŸŒ§ï¸') ? 'rainy' : 'snowy'\n        });\n      }, 300);\n    }),\n    // Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°\n    new Promise(resolve => {\n      setTimeout(() => {\n        resolve({\n          type: 'stats',\n          data: {\n            totalExhibits: 150,\n            onDisplay: 120,\n            inStorage: 20,\n            underRestoration: 10,\n            popularCategory: 'art',\n            lastUpdated: new Date().toISOString()\n          }\n        });\n      }, 500);\n    })]);\n    console.log('âœ… Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´Ð° Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ñ‹');\n    return {\n      success: true,\n      timestamp: new Date().toISOString(),\n      data: {\n        exhibits,\n        visitors,\n        events,\n        weather,\n        stats\n      },\n      summary: {\n        totalDataPoints: exhibits.count + visitors.data.today + events.upcoming,\n        loadTime: 1600,\n        // Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸\n        status: 'complete'\n      }\n    };\n  } catch (error) {\n    console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´Ð°:', error);\n    return {\n      success: false,\n      error: error.message,\n      timestamp: new Date().toISOString(),\n      fallbackData: {\n        exhibits: {\n          count: 0,\n          data: []\n        },\n        visitors: {\n          today: 0,\n          week: 0,\n          month: 0\n        },\n        events: {\n          upcoming: 0,\n          data: []\n        },\n        weather: {\n          temperature: 20,\n          condition: 'ÐÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾'\n        }\n      }\n    };\n  }\n};\n\n// 5. ÐžÑ‚Ð¼ÐµÐ½Ð° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ñ AbortController\nexport const fetchWithTimeout = (url, options = {}, timeout = 5000) => {\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => controller.abort(), timeout);\n  return fetch(url, {\n    ...options,\n    signal: controller.signal\n  }).then(response => {\n    clearTimeout(timeoutId);\n    return response;\n  }).catch(error => {\n    clearTimeout(timeoutId);\n    if (error.name === 'AbortError') {\n      throw new Error(`Ð—Ð°Ð¿Ñ€Ð¾Ñ Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½ Ð¿Ð¾ Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚Ñƒ (${timeout}Ð¼Ñ)`);\n    }\n    throw error;\n  });\n};\n\n// 6. Ð ÐµÑ‚Ñ€Ð¸ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ñ ÑÐºÑÐ¿Ð¾Ð½ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¾Ñ‚ÑÑ€Ð¾Ñ‡ÐºÐ¾Ð¹\nexport const fetchWithRetry = async (url, options = {}, maxRetries = 3, baseDelay = 1000) => {\n  for (let attempt = 1; attempt <= maxRetries; attempt++) {\n    try {\n      console.log(`ÐŸÐ¾Ð¿Ñ‹Ñ‚ÐºÐ° ${attempt} Ð¸Ð· ${maxRetries}`);\n      const response = await fetch(url, options);\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error(`ÐžÑˆÐ¸Ð±ÐºÐ° Ð½Ð° Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐµ ${attempt}:`, error.message);\n      if (attempt === maxRetries) {\n        throw new Error(`ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð¿Ð¾ÑÐ»Ðµ ${maxRetries} Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº`);\n      }\n      const delay = baseDelay * Math.pow(2, attempt - 1);\n      console.log(`Ð–Ð´ÐµÐ¼ ${delay}Ð¼Ñ Ð¿ÐµÑ€ÐµÐ´ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¹ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¾Ð¹...`);\n      await new Promise(resolve => setTimeout(resolve, delay));\n    }\n  }\n};","map":{"version":3,"names":["uploadFileWithProgress","file","onProgress","onComplete","Promise","resolve","reject","xhr","XMLHttpRequest","upload","addEventListener","e","lengthComputable","progress","Math","round","loaded","total","status","response","JSON","parse","responseText","error","Error","formData","FormData","append","Date","toISOString","open","setRequestHeader","send","createTimerWithPersistence","name","duration","onTick","remaining","timerId","savedTime","localStorage","getItem","savedData","elapsed","now","timestamp","max","floor","console","saveState","setItem","stringify","totalDuration","tick","hours","minutes","seconds","log","toString","padStart","clearInterval","removeItem","setInterval","stop","reset","getRemaining","getName","isRunning","bookTourWithValidation","tourId","visitorCount","paymentMethod","availability","setTimeout","isAvailable","random","available","message","maxCapacity","validation","valid","payment","isPaymentSuccessful","success","transactionId","substr","amount","currency","method","booking","bookingId","toUpperCase","totalAmount","bookingDate","qrCodeUrl","data","nextSteps","recoverySteps","fetchDashboardData","exhibits","visitors","events","weather","stats","all","fetch","then","res","json","type","count","updated","catch","today","week","month","averageDaily","trend","changePercent","id","date","seats","upcoming","totalThisMonth","conditions","condition","length","temperature","humidity","feelsLike","windSpeed","forecast","icon","includes","totalExhibits","onDisplay","inStorage","underRestoration","popularCategory","lastUpdated","summary","totalDataPoints","loadTime","fallbackData","fetchWithTimeout","url","options","timeout","controller","AbortController","timeoutId","abort","signal","clearTimeout","fetchWithRetry","maxRetries","baseDelay","attempt","ok","delay","pow"],"sources":["C:/Users/user/React_museum/museum/client/src/components/asyncOperations.js"],"sourcesContent":["// ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ñ… Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹\r\n\r\n// 1. XMLHttpRequest Ñ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ¾Ð¼\r\nexport const uploadFileWithProgress = (file, onProgress, onComplete) => {\r\n  return new Promise((resolve, reject) => {\r\n    const xhr = new XMLHttpRequest();\r\n    \r\n    xhr.upload.addEventListener('progress', (e) => {\r\n      if (e.lengthComputable && onProgress) {\r\n        const progress = Math.round((e.loaded * 100) / e.total);\r\n        onProgress(progress);\r\n      }\r\n    });\r\n    \r\n    xhr.addEventListener('load', () => {\r\n      if (xhr.status === 200) {\r\n        try {\r\n          const response = JSON.parse(xhr.responseText);\r\n          if (onComplete) onComplete(response);\r\n          resolve(response);\r\n        } catch (error) {\r\n          reject(new Error('Invalid JSON response'));\r\n        }\r\n      } else {\r\n        reject(new Error(`Upload failed: ${xhr.status}`));\r\n      }\r\n    });\r\n    \r\n    xhr.addEventListener('error', () => {\r\n      reject(new Error('Network error during upload'));\r\n    });\r\n    \r\n    xhr.addEventListener('abort', () => {\r\n      reject(new Error('Upload aborted'));\r\n    });\r\n    \r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n    formData.append('uploadTime', new Date().toISOString());\r\n    \r\n    xhr.open('POST', 'http://localhost:5000/api/upload');\r\n    xhr.setRequestHeader('Accept', 'application/json');\r\n    xhr.send(formData);\r\n  });\r\n};\r\n\r\n// 2. setTimeout Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸ÐµÐ¼ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ\r\nexport const createTimerWithPersistence = (name, duration, onTick, onComplete) => {\r\n  let remaining = duration;\r\n  let timerId = null;\r\n  \r\n  // Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ð¾Ð³Ð¾ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ\r\n  const savedTime = localStorage.getItem(`timer_${name}`);\r\n  if (savedTime) {\r\n    try {\r\n      const savedData = JSON.parse(savedTime);\r\n      const elapsed = Date.now() - savedData.timestamp;\r\n      remaining = Math.max(0, savedData.remaining - Math.floor(elapsed / 1000));\r\n    } catch (error) {\r\n      console.error('Error loading timer state:', error);\r\n    }\r\n  }\r\n  \r\n  const saveState = () => {\r\n    localStorage.setItem(`timer_${name}`, JSON.stringify({\r\n      remaining,\r\n      timestamp: Date.now(),\r\n      name,\r\n      totalDuration: duration\r\n    }));\r\n  };\r\n  \r\n  const tick = () => {\r\n    if (remaining > 0) {\r\n      remaining--;\r\n      saveState();\r\n      \r\n      if (onTick) {\r\n        onTick(remaining);\r\n      }\r\n      \r\n      // Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸\r\n      const hours = Math.floor(remaining / 3600);\r\n      const minutes = Math.floor((remaining % 3600) / 60);\r\n      const seconds = remaining % 60;\r\n      \r\n      console.log(`Ð¢Ð°Ð¹Ð¼ÐµÑ€ \"${name}\": ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`);\r\n    } else {\r\n      clearInterval(timerId);\r\n      localStorage.removeItem(`timer_${name}`);\r\n      if (onComplete) onComplete();\r\n    }\r\n  };\r\n  \r\n  timerId = setInterval(tick, 1000);\r\n  \r\n  // ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ðµ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ\r\n  saveState();\r\n  \r\n  return {\r\n    stop: () => {\r\n      if (timerId) {\r\n        clearInterval(timerId);\r\n        saveState();\r\n      }\r\n    },\r\n    reset: () => {\r\n      if (timerId) clearInterval(timerId);\r\n      remaining = duration;\r\n      saveState();\r\n      timerId = setInterval(tick, 1000);\r\n    },\r\n    getRemaining: () => remaining,\r\n    getName: () => name,\r\n    isRunning: () => timerId !== null\r\n  };\r\n};\r\n\r\n// 3. Promise Ñ†ÐµÐ¿Ð¾Ñ‡ÐºÐ° Ð´Ð»Ñ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ\r\nexport const bookTourWithValidation = async (tourId, visitorCount, paymentMethod) => {\r\n  console.log('ðŸš€ ÐÐ°Ñ‡Ð°Ð»Ð¾ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ‚ÑƒÑ€Ð°...');\r\n  \r\n  try {\r\n    // Ð¨Ð°Ð³ 1: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸\r\n    const availability = await new Promise((resolve, reject) => {\r\n      setTimeout(() => {\r\n        const isAvailable = Math.random() > 0.1;\r\n        if (isAvailable) {\r\n          resolve({ \r\n            available: true, \r\n            message: 'ÐœÐµÑÑ‚Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹',\r\n            tourId,\r\n            maxCapacity: 20\r\n          });\r\n        } else {\r\n          reject(new Error('ÐÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… Ð¼ÐµÑÑ‚ Ð½Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ'));\r\n        }\r\n      }, 800);\r\n    });\r\n    \r\n    console.log('âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸:', availability);\r\n    \r\n    // Ð¨Ð°Ð³ 2: Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…\r\n    const validation = await new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        if (visitorCount > 0 && visitorCount <= availability.maxCapacity) {\r\n          resolve({ \r\n            valid: true, \r\n            message: 'Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐµÐ½Ñ‹',\r\n            visitorCount \r\n          });\r\n        } else {\r\n          resolve({ \r\n            valid: false, \r\n            message: `ÐÐµÐ²ÐµÑ€Ð½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ð¾ÑÐµÑ‚Ð¸Ñ‚ÐµÐ»ÐµÐ¹ (Ð¼Ð°ÐºÑ: ${availability.maxCapacity})` \r\n          });\r\n        }\r\n      }, 600);\r\n    });\r\n    \r\n    if (!validation.valid) {\r\n      throw new Error(validation.message);\r\n    }\r\n    \r\n    console.log('âœ… Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…:', validation);\r\n    \r\n    // Ð¨Ð°Ð³ 3: ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°\r\n    const payment = await new Promise((resolve, reject) => {\r\n      setTimeout(() => {\r\n        const isPaymentSuccessful = Math.random() > 0.05;\r\n        if (isPaymentSuccessful) {\r\n          resolve({\r\n            success: true,\r\n            transactionId: `TXN-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n            amount: visitorCount * 500,\r\n            currency: 'RUB',\r\n            method: paymentMethod,\r\n            timestamp: new Date().toISOString()\r\n          });\r\n        } else {\r\n          reject(new Error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°'));\r\n        }\r\n      }, 1500);\r\n    });\r\n    \r\n    console.log('âœ… ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ð»Ð°Ñ‚ÐµÐ¶Ð°:', payment);\r\n    \r\n    // Ð¨Ð°Ð³ 4: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð±Ñ€Ð¾Ð½Ð¸\r\n    const booking = await new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        resolve({\r\n          bookingId: `BOOK-${Date.now()}-${Math.random().toString(36).substr(2, 6).toUpperCase()}`,\r\n          tourId,\r\n          visitorCount,\r\n          totalAmount: payment.amount,\r\n          bookingDate: new Date().toISOString(),\r\n          status: 'confirmed',\r\n          qrCodeUrl: `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=booking-${Date.now()}`\r\n        });\r\n      }, 700);\r\n    });\r\n    \r\n    console.log('âœ… Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð±Ñ€Ð¾Ð½Ð¸:', booking);\r\n    \r\n    // Ð¨Ð°Ð³ 5: ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ\r\n    await new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        console.log('ðŸ“§ ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ð½Ð° email');\r\n        resolve();\r\n      }, 300);\r\n    });\r\n    \r\n    return {\r\n      success: true,\r\n      message: 'Ð‘Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾!',\r\n      data: { \r\n        availability, \r\n        validation, \r\n        payment, \r\n        booking \r\n      },\r\n      timestamp: new Date().toISOString(),\r\n      nextSteps: [\r\n        'ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð²Ð°ÑˆÑƒ Ð¿Ð¾Ñ‡Ñ‚Ñƒ',\r\n        'Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚Ðµ QR-ÐºÐ¾Ð´',\r\n        'ÐŸÑ€Ð¸Ñ…Ð¾Ð´Ð¸Ñ‚Ðµ Ð·Ð° 15 Ð¼Ð¸Ð½ÑƒÑ‚ Ð´Ð¾ Ð½Ð°Ñ‡Ð°Ð»Ð°'\r\n      ]\r\n    };\r\n    \r\n  } catch (error) {\r\n    console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ:', error);\r\n    \r\n    // ÐžÑ‚ÐºÐ°Ñ‚ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹\r\n    await new Promise(resolve => {\r\n      setTimeout(() => {\r\n        console.log('ðŸ”„ Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ÑÑ Ð¾Ñ‚ÐºÐ°Ñ‚ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹...');\r\n        resolve();\r\n      }, 500);\r\n    });\r\n    \r\n    return {\r\n      success: false,\r\n      error: error.message,\r\n      timestamp: new Date().toISOString(),\r\n      recoverySteps: [\r\n        'ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚ÑŒ Ð¼ÐµÑÑ‚',\r\n        'ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð´Ñ€ÑƒÐ³Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ',\r\n        'Ð¡Ð²ÑÐ¶Ð¸Ñ‚ÐµÑÑŒ Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹'\r\n      ]\r\n    };\r\n  }\r\n};\r\n\r\n// 4. ÐŸÐ°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ñ Promise.all\r\nexport const fetchDashboardData = async () => {\r\n  console.log('ðŸ“Š Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´Ð°...');\r\n  \r\n  try {\r\n    const [exhibits, visitors, events, weather, stats] = await Promise.all([\r\n      // Ð­ÐºÑÐ¿Ð¾Ð½Ð°Ñ‚Ñ‹\r\n      fetch('http://localhost:5000/api/exhibits?limit=5')\r\n        .then(res => res.json())\r\n        .then(data => ({ \r\n          type: 'exhibits', \r\n          data: data.exhibits, \r\n          count: data.total,\r\n          updated: new Date().toISOString()\r\n        }))\r\n        .catch(() => ({ \r\n          type: 'exhibits', \r\n          data: [], \r\n          count: 0,\r\n          error: 'Failed to load exhibits'\r\n        })),\r\n      \r\n      // ÐŸÐ¾ÑÐµÑ‚Ð¸Ñ‚ÐµÐ»Ð¸\r\n      new Promise(resolve => {\r\n        setTimeout(() => {\r\n          resolve({\r\n            type: 'visitors',\r\n            data: {\r\n              today: Math.floor(Math.random() * 100) + 50,\r\n              week: Math.floor(Math.random() * 1000) + 500,\r\n              month: Math.floor(Math.random() * 5000) + 2000,\r\n              averageDaily: Math.floor(Math.random() * 150) + 100\r\n            },\r\n            trend: 'up',\r\n            changePercent: 12\r\n          });\r\n        }, 600);\r\n      }),\r\n      \r\n      // Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ñ\r\n      new Promise(resolve => {\r\n        setTimeout(() => {\r\n          resolve({\r\n            type: 'events',\r\n            data: [\r\n              { id: 1, name: 'ÐÐ¾Ñ‡Ð½Ð°Ñ ÑÐºÑÐºÑƒÑ€ÑÐ¸Ñ', date: '2024-04-15', seats: 15 },\r\n              { id: 2, name: 'ÐœÐ°ÑÑ‚ÐµÑ€-ÐºÐ»Ð°ÑÑ', date: '2024-04-20', seats: 10 },\r\n              { id: 3, name: 'Ð›ÐµÐºÑ†Ð¸Ñ Ð¾Ð± Ð¸ÑÐºÑƒÑÑÑ‚Ð²Ðµ', date: '2024-04-25', seats: 20 }\r\n            ],\r\n            upcoming: 3,\r\n            totalThisMonth: 12\r\n          });\r\n        }, 400);\r\n      }),\r\n      \r\n      // ÐŸÐ¾Ð³Ð¾Ð´Ð°\r\n      new Promise(resolve => {\r\n        setTimeout(() => {\r\n          const conditions = ['â˜€ï¸ Ð¡Ð¾Ð»Ð½ÐµÑ‡Ð½Ð¾', 'â›… ÐžÐ±Ð»Ð°Ñ‡Ð½Ð¾', 'ðŸŒ§ï¸ Ð”Ð¾Ð¶Ð´ÑŒ', 'â„ï¸ Ð¡Ð½ÐµÐ³'];\r\n          const condition = conditions[Math.floor(Math.random() * conditions.length)];\r\n          \r\n          resolve({\r\n            type: 'weather',\r\n            data: {\r\n              temperature: Math.floor(Math.random() * 15) + 15,\r\n              condition: condition,\r\n              humidity: Math.floor(Math.random() * 40) + 40,\r\n              feelsLike: Math.floor(Math.random() * 15) + 15,\r\n              windSpeed: Math.floor(Math.random() * 10) + 5\r\n            },\r\n            forecast: 'Ð¡Ñ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð°Ñ Ð¿Ð¾Ð³Ð¾Ð´Ð°',\r\n            icon: condition.includes('â˜€ï¸') ? 'sunny' : \r\n                  condition.includes('â›…') ? 'cloudy' : \r\n                  condition.includes('ðŸŒ§ï¸') ? 'rainy' : 'snowy'\r\n          });\r\n        }, 300);\r\n      }),\r\n      \r\n      // Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°\r\n      new Promise(resolve => {\r\n        setTimeout(() => {\r\n          resolve({\r\n            type: 'stats',\r\n            data: {\r\n              totalExhibits: 150,\r\n              onDisplay: 120,\r\n              inStorage: 20,\r\n              underRestoration: 10,\r\n              popularCategory: 'art',\r\n              lastUpdated: new Date().toISOString()\r\n            }\r\n          });\r\n        }, 500);\r\n      })\r\n    ]);\r\n    \r\n    console.log('âœ… Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´Ð° Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ñ‹');\r\n    \r\n    return {\r\n      success: true,\r\n      timestamp: new Date().toISOString(),\r\n      data: {\r\n        exhibits,\r\n        visitors,\r\n        events,\r\n        weather,\r\n        stats\r\n      },\r\n      summary: {\r\n        totalDataPoints: exhibits.count + visitors.data.today + events.upcoming,\r\n        loadTime: 1600, // Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸\r\n        status: 'complete'\r\n      }\r\n    };\r\n    \r\n  } catch (error) {\r\n    console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´Ð°:', error);\r\n    return {\r\n      success: false,\r\n      error: error.message,\r\n      timestamp: new Date().toISOString(),\r\n      fallbackData: {\r\n        exhibits: { count: 0, data: [] },\r\n        visitors: { today: 0, week: 0, month: 0 },\r\n        events: { upcoming: 0, data: [] },\r\n        weather: { temperature: 20, condition: 'ÐÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾' }\r\n      }\r\n    };\r\n  }\r\n};\r\n\r\n// 5. ÐžÑ‚Ð¼ÐµÐ½Ð° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ñ AbortController\r\nexport const fetchWithTimeout = (url, options = {}, timeout = 5000) => {\r\n  const controller = new AbortController();\r\n  const timeoutId = setTimeout(() => controller.abort(), timeout);\r\n  \r\n  return fetch(url, {\r\n    ...options,\r\n    signal: controller.signal\r\n  })\r\n    .then(response => {\r\n      clearTimeout(timeoutId);\r\n      return response;\r\n    })\r\n    .catch(error => {\r\n      clearTimeout(timeoutId);\r\n      if (error.name === 'AbortError') {\r\n        throw new Error(`Ð—Ð°Ð¿Ñ€Ð¾Ñ Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½ Ð¿Ð¾ Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚Ñƒ (${timeout}Ð¼Ñ)`);\r\n      }\r\n      throw error;\r\n    });\r\n};\r\n\r\n// 6. Ð ÐµÑ‚Ñ€Ð¸ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ñ ÑÐºÑÐ¿Ð¾Ð½ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¾Ñ‚ÑÑ€Ð¾Ñ‡ÐºÐ¾Ð¹\r\nexport const fetchWithRetry = async (\r\n  url,\r\n  options = {},\r\n  maxRetries = 3,\r\n  baseDelay = 1000\r\n) => {\r\n  for (let attempt = 1; attempt <= maxRetries; attempt++) {\r\n    try {\r\n      console.log(`ÐŸÐ¾Ð¿Ñ‹Ñ‚ÐºÐ° ${attempt} Ð¸Ð· ${maxRetries}`);\r\n      const response = await fetch(url, options);\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}`);\r\n      }\r\n      \r\n      return await response.json();\r\n    } catch (error) {\r\n      console.error(`ÐžÑˆÐ¸Ð±ÐºÐ° Ð½Ð° Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐµ ${attempt}:`, error.message);\r\n      \r\n      if (attempt === maxRetries) {\r\n        throw new Error(`ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð¿Ð¾ÑÐ»Ðµ ${maxRetries} Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº`);\r\n      }\r\n      \r\n      const delay = baseDelay * Math.pow(2, attempt - 1);\r\n      console.log(`Ð–Ð´ÐµÐ¼ ${delay}Ð¼Ñ Ð¿ÐµÑ€ÐµÐ´ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¹ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¾Ð¹...`);\r\n      await new Promise(resolve => setTimeout(resolve, delay));\r\n    }\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}