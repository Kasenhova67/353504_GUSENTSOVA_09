{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\React_museum\\\\museum\\\\client\\\\src\\\\components\\\\GoogleAuthButton.js\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { useGoogleLogin } from '@react-oauth/google';\nimport { useAuth } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GoogleAuthButton = () => {\n  _s();\n  const {\n    loginWithGoogle,\n    addNotification\n  } = useAuth();\n  const handleSuccess = async response => {\n    try {\n      console.log('✅ Google OAuth успешен:', response);\n      if (response.credential) {\n        const idToken = response.credential;\n        console.log('ID Token получен, длина:', idToken.length);\n        const serverResponse = await fetch('http://localhost:5000/api/auth/google', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            id_token: idToken\n          })\n        });\n        if (!serverResponse.ok) {\n          const errorData = await serverResponse.json();\n          throw new Error(errorData.message || 'Ошибка сервера');\n        }\n        const serverData = await serverResponse.json();\n        if (serverData.success) {\n          const userInfo = await fetch('https://www.googleapis.com/oauth2/v3/userinfo', {\n            headers: {\n              'Authorization': `Bearer ${idToken}`\n            }\n          }).then(res => res.json());\n          const userData = {\n            ...serverData.user,\n            googleId: userInfo.sub || serverData.user._id,\n            email: userInfo.email || serverData.user.email,\n            name: userInfo.name || serverData.user.name,\n            picture: userInfo.picture || '',\n            verified_email: userInfo.email_verified || false\n          };\n          loginWithGoogle(userData);\n          setTimeout(() => {\n            window.location.href = '/';\n          }, 1000);\n        } else {\n          throw new Error(serverData.message || 'Ошибка авторизации');\n        }\n      } else {\n        throw new Error('ID Token не получен от Google');\n      }\n    } catch (error) {\n      console.error(' Ошибка Google OAuth:', error);\n      addNotification(`Ошибка входа через Google: ${error.message}`, 'error');\n    }\n  };\n  const handleError = error => {\n    console.error(' Google OAuth ошибка:', error);\n    addNotification('Ошибка авторизации через Google', 'error');\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"google-auth-wrapper\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"google-divider\",\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"\\u0418\\u043B\\u0438 \\u0432\\u043E\\u0439\\u0434\\u0438\\u0442\\u0435 \\u0447\\u0435\\u0440\\u0435\\u0437 Google\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"useGoogleLogin\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"script\", {\n      src: \"https://accounts.google.com/gsi/client\",\n      async: true,\n      defer: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"script\", {\n      dangerouslySetInnerHTML: {\n        __html: `\n          function handleCredentialResponse(response) {\n            console.log('Google ID Token получен');\n            window.handleGoogleSignIn(response);\n          }\n          \n          window.google.accounts.id.initialize({\n            client_id: '${process.env.REACT_APP_GOOGLE_CLIENT_ID}',\n            callback: handleCredentialResponse,\n            auto_select: false,\n            cancel_on_tap_outside: true,\n            context: 'signin',\n            ux_mode: 'popup'\n          });\n          \n          window.google.accounts.id.renderButton(\n            document.getElementById(\"googleSignInButton\"),\n            {\n              theme: \"filled_blue\",\n              size: \"large\",\n              text: \"signin_with\",\n              shape: \"rectangular\",\n              width: 300\n            }\n          );\n          \n          window.handleGoogleSignIn = function(response) {\n            // Это будет вызвано из handleCredentialResponse\n            window.dispatchEvent(new CustomEvent('googleSignIn', {\n              detail: response\n            }));\n          };\n        `\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"google-note\",\n      children: \"\\u041C\\u044B \\u043D\\u0435 \\u043F\\u0435\\u0440\\u0435\\u0434\\u0430\\u0435\\u043C \\u0432\\u0430\\u0448\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u0442\\u0440\\u0435\\u0442\\u044C\\u0438\\u043C \\u043B\\u0438\\u0446\\u0430\\u043C\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 5\n  }, this);\n};\n_s(GoogleAuthButton, \"QnJ+2AwH71ISRGv/2s2y0+Gp2CQ=\", false, function () {\n  return [useAuth];\n});\n_c = GoogleAuthButton;\nexport default GoogleAuthButton;\nvar _c;\n$RefreshReg$(_c, \"GoogleAuthButton\");","map":{"version":3,"names":["React","useGoogleLogin","useAuth","jsxDEV","_jsxDEV","GoogleAuthButton","_s","loginWithGoogle","addNotification","handleSuccess","response","console","log","credential","idToken","length","serverResponse","fetch","method","headers","body","JSON","stringify","id_token","ok","errorData","json","Error","message","serverData","success","userInfo","then","res","userData","user","googleId","sub","_id","email","name","picture","verified_email","email_verified","setTimeout","window","location","href","error","handleError","className","children","fileName","_jsxFileName","lineNumber","columnNumber","id","src","async","defer","dangerouslySetInnerHTML","__html","process","env","REACT_APP_GOOGLE_CLIENT_ID","_c","$RefreshReg$"],"sources":["C:/Users/user/React_museum/museum/client/src/components/GoogleAuthButton.js"],"sourcesContent":["import React from 'react';\r\nimport { useGoogleLogin } from '@react-oauth/google';\r\nimport { useAuth } from './AuthContext';\r\n\r\nconst GoogleAuthButton = () => {\r\n  const { loginWithGoogle, addNotification } = useAuth();\r\n\r\n  const handleSuccess = async (response) => {\r\n    try {\r\n      console.log('✅ Google OAuth успешен:', response);\r\n      \r\n      if (response.credential) {\r\n       \r\n        const idToken = response.credential;\r\n        console.log('ID Token получен, длина:', idToken.length);\r\n        \r\n        const serverResponse = await fetch('http://localhost:5000/api/auth/google', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify({\r\n            id_token: idToken  \r\n          })\r\n        });\r\n\r\n        if (!serverResponse.ok) {\r\n          const errorData = await serverResponse.json();\r\n          throw new Error(errorData.message || 'Ошибка сервера');\r\n        }\r\n\r\n        const serverData = await serverResponse.json();\r\n        \r\n        if (serverData.success) {\r\n          const userInfo = await fetch('https://www.googleapis.com/oauth2/v3/userinfo', {\r\n            headers: {\r\n              'Authorization': `Bearer ${idToken}`\r\n            }\r\n          }).then(res => res.json());\r\n          \r\n          const userData = {\r\n            ...serverData.user,\r\n            googleId: userInfo.sub || serverData.user._id,\r\n            email: userInfo.email || serverData.user.email,\r\n            name: userInfo.name || serverData.user.name,\r\n            picture: userInfo.picture || '',\r\n            verified_email: userInfo.email_verified || false\r\n          };\r\n          \r\n          loginWithGoogle(userData);\r\n          \r\n          setTimeout(() => {\r\n            window.location.href = '/';\r\n          }, 1000);\r\n          \r\n        } else {\r\n          throw new Error(serverData.message || 'Ошибка авторизации');\r\n        }\r\n      } else {\r\n        throw new Error('ID Token не получен от Google');\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error(' Ошибка Google OAuth:', error);\r\n      addNotification(`Ошибка входа через Google: ${error.message}`, 'error');\r\n    }\r\n  };\r\n\r\n  const handleError = (error) => {\r\n    console.error(' Google OAuth ошибка:', error);\r\n    addNotification('Ошибка авторизации через Google', 'error');\r\n  };\r\n  return (\r\n    <div className=\"google-auth-wrapper\">\r\n      <div className=\"google-divider\">\r\n        <span>Или войдите через Google</span>\r\n      </div>\r\n      \r\n      <div id=\"useGoogleLogin\"></div>\r\n      \r\n      <script src=\"https://accounts.google.com/gsi/client\" async defer></script>\r\n      <script dangerouslySetInnerHTML={{\r\n        __html: `\r\n          function handleCredentialResponse(response) {\r\n            console.log('Google ID Token получен');\r\n            window.handleGoogleSignIn(response);\r\n          }\r\n          \r\n          window.google.accounts.id.initialize({\r\n            client_id: '${process.env.REACT_APP_GOOGLE_CLIENT_ID}',\r\n            callback: handleCredentialResponse,\r\n            auto_select: false,\r\n            cancel_on_tap_outside: true,\r\n            context: 'signin',\r\n            ux_mode: 'popup'\r\n          });\r\n          \r\n          window.google.accounts.id.renderButton(\r\n            document.getElementById(\"googleSignInButton\"),\r\n            {\r\n              theme: \"filled_blue\",\r\n              size: \"large\",\r\n              text: \"signin_with\",\r\n              shape: \"rectangular\",\r\n              width: 300\r\n            }\r\n          );\r\n          \r\n          window.handleGoogleSignIn = function(response) {\r\n            // Это будет вызвано из handleCredentialResponse\r\n            window.dispatchEvent(new CustomEvent('googleSignIn', {\r\n              detail: response\r\n            }));\r\n          };\r\n        `\r\n      }} />\r\n      \r\n      <p className=\"google-note\">\r\n        Мы не передаем ваши данные третьим лицам\r\n      </p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GoogleAuthButton;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}