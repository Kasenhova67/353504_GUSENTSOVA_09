{"ast":null,"code":"const OLLAMA_API_URL = 'http://localhost:11434/api';\nexport const checkOllamaStatus = async () => {\n  try {\n    var _data$models;\n    const response = await fetch(`${OLLAMA_API_URL}/tags`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      timeout: 3000\n    });\n    if (!response.ok) {\n      console.warn('‚ö†Ô∏è Ollama –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç, —Å—Ç–∞—Ç—É—Å:', response.status);\n      return {\n        available: false,\n        models: [],\n        message: 'Ollama –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω',\n        error: `HTTP ${response.status}`\n      };\n    }\n    const data = await response.json();\n    ;\n    return {\n      available: true,\n      models: data.models || [],\n      message: `–î–æ—Å—Ç—É–ø–Ω–æ –º–æ–¥–µ–ª–µ–π: ${((_data$models = data.models) === null || _data$models === void 0 ? void 0 : _data$models.length) || 0}`,\n      details: data.models\n    };\n  } catch (error) {\n    console.warn('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Ollama:', error.message);\n    return {\n      available: false,\n      models: [],\n      message: 'Ollama –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å https://ollama.ai/',\n      error: error.message\n    };\n  }\n};\nexport const analyzeWithOllama = async (exhibit, analysisType = 'description') => {\n  var _status$models$;\n  const startTime = Date.now();\n  const status = await checkOllamaStatus();\n  if (!status.available) {\n    console.log('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º (Ollama –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω)');\n    return getDemoResponse(exhibit, analysisType);\n  }\n  const hasMistral = status.models.some(model => model.name.includes('mistral'));\n  const modelToUse = hasMistral ? 'mistral' : ((_status$models$ = status.models[0]) === null || _status$models$ === void 0 ? void 0 : _status$models$.name) || 'mistral';\n  const prompt = generatePrompt(exhibit, analysisType);\n  try {\n    const response = await fetch(`${OLLAMA_API_URL}/generate`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      body: JSON.stringify({\n        model: modelToUse,\n        prompt: prompt,\n        stream: false,\n        options: {\n          temperature: 0.7,\n          top_p: 0.9,\n          top_k: 40,\n          num_predict: 100,\n          repeat_penalty: 1.1,\n          seed: 42\n        },\n        system: getSystemPrompt(analysisType)\n      })\n    });\n    if (!response.ok) {\n      throw new Error(`–û—à–∏–±–∫–∞ Ollama API: ${response.status} ${response.statusText}`);\n    }\n    const data = await response.json();\n    const endTime = Date.now();\n    const processingTime = endTime - startTime;\n    console.log(`‚úÖ AI –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ ${processingTime}–º—Å`);\n    return {\n      success: true,\n      content: formatResponse(data.response, analysisType),\n      model: data.model,\n      time: processingTime,\n      tokens: data.total_duration ? Math.round(data.total_duration / 1000000) : 0,\n      type: analysisType,\n      title: getAnalysisTitle(analysisType),\n      note: `–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –º–æ–¥–µ–ª—å—é ${data.model} –∑–∞ ${processingTime}–º—Å`,\n      raw: data.response,\n      status: 'success'\n    };\n  } catch (error) {\n    console.error('‚ùå –û—à–∏–±–∫–∞ AI –∞–Ω–∞–ª–∏–∑–∞:', error);\n    const endTime = Date.now();\n    return {\n      success: false,\n      content: getFallbackResponse(exhibit, analysisType),\n      model: 'error',\n      time: endTime - startTime,\n      tokens: 0,\n      type: analysisType,\n      title: getAnalysisTitle(analysisType) + ' (–æ—à–∏–±–∫–∞)',\n      note: `–û—à–∏–±–∫–∞: ${error.message}. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω.`,\n      error: error.message,\n      status: 'error'\n    };\n  }\n};\nconst getSystemPrompt = analysisType => {\n  const prompts = {\n    description: `–¢—ã - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥ –∏ —ç–∫—Å–ø–µ—Ä—Ç –º—É–∑–µ—è. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - —Å–æ–∑–¥–∞–≤–∞—Ç—å —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ, \n–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –º—É–∑–µ–π–Ω—ã—Ö —ç–∫—Å–ø–æ–Ω–∞—Ç–æ–≤.`,\n    conservation: `–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–∏ –∏ —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –º—É–∑–µ–π–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π —Å 20-–ª–µ—Ç–Ω–∏–º –æ–ø—ã—Ç–æ–º..`,\n    art: `–¢—ã - –≤–µ–¥—É—â–∏–π –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥, —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞.\n–ü—Ä–æ–≤–æ–¥–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π.`\n  };\n  return prompts[analysisType] || prompts.description;\n};\nconst generatePrompt = (exhibit, analysisType) => {\n  const {\n    name = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —ç–∫—Å–ø–æ–Ω–∞—Ç',\n    description = '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç',\n    category = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è',\n    year = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –≥–æ–¥',\n    materials = [],\n    conservationState = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',\n    dimensions = {},\n    location = {},\n    value = '–ù–µ –æ—Ü–µ–Ω–µ–Ω–æ'\n  } = exhibit;\n  const materialsText = Array.isArray(materials) ? materials.join(', ') : materials;\n  const dimensionsText = dimensions ? `–í—ã—Å–æ—Ç–∞: ${dimensions.height || '?'}—Å–º, –®–∏—Ä–∏–Ω–∞: ${dimensions.width || '?'}—Å–º, –ì–ª—É–±–∏–Ω–∞: ${dimensions.depth || '?'}—Å–º` : '–ù–µ —É–∫–∞–∑–∞–Ω—ã';\n  const locationText = location ? `–ó–∞–ª: ${location.hall || '?'}, –ö–æ–º–Ω–∞—Ç–∞: ${location.room || '?'}` : '–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ';\n  const baseInfo = `\n–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –≠–ö–°–ü–û–ù–ê–¢–ï:\n–ù–∞–∑–≤–∞–Ω–∏–µ: ${name}\n–û–ø–∏—Å–∞–Ω–∏–µ: ${description}\n`.trim();\n  switch (analysisType) {\n    case 'description':\n      return `${baseInfo}\n–°–æ–∑–¥–∞–π –ø–æ–¥—Ä–æ–±–Ω–æ–µ, —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –º—É–∑–µ–π–Ω–æ–≥–æ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞ –¥–ª—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π.\n–î–ª–∏–Ω–∞: –ø—Ä–∏–º–µ—Ä–Ω–æ 50-100 —Å–ª–æ–≤.`;\n    case 'conservation':\n      return `${baseInfo}\n–ü—Ä–æ–≤–µ–¥–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏ –∏ –¥–∞–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:\n1. –û—Ü–µ–Ω–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–æ—Ç 1 –¥–æ 10)\n2. –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∏—Å–∫–∏ –∏ —É–≥—Ä–æ–∑—ã.`;\n    case 'art':\n      return `${baseInfo}\n–ü—Ä–æ–≤–µ–¥–∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:\n1. –°–∏–º–≤–æ–ª–∏–∫–∞ –∏ —Å–º—ã—Å–ª–æ–≤–æ–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ\n2. –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å.`;\n    default:\n      return `${baseInfo}\n–°–¥–µ–ª–∞–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —ç—Ç–æ–≥–æ –º—É–∑–µ–π–Ω–æ–≥–æ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞.`;\n  }\n};\nconst formatResponse = (response, type) => {\n  let cleaned = response.replace(/^\\s+/, '').replace(/\\s+$/, '').replace(/\\n\\s*\\n\\s*\\n/g, '\\n\\n');\n  switch (type) {\n    case 'description':\n      if (!cleaned.includes('#') && !cleaned.includes('##')) {\n        cleaned = `# ${getAnalysisTitle(type)}\\n\\n${cleaned}`;\n      }\n      break;\n    case 'conservation':\n      if (!cleaned.includes('##')) {\n        cleaned = `# –û—Ç—á–µ—Ç –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏\\n\\n${cleaned}`;\n      }\n      break;\n    case 'art':\n      if (!cleaned.includes('##')) {\n        cleaned = `# –ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑\\n\\n${cleaned}`;\n      }\n      break;\n  }\n  return cleaned;\n};\nconst getAnalysisTitle = type => {\n  const titles = {\n    description: 'üìù AI-–æ–ø–∏—Å–∞–Ω–∏–µ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞',\n    conservation: 'üõ°Ô∏è –ê–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏',\n    art: 'üé® –ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑',\n    history: 'üìú –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç'\n  };\n  return titles[type] || 'ü§ñ AI –∞–Ω–∞–ª–∏–∑';\n};\nconst getDemoResponse = (exhibit, type) => {\n  const {\n    name = '–≠–∫—Å–ø–æ–Ω–∞—Ç',\n    category = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è',\n    year = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –≥–æ–¥',\n    materials = [],\n    conservationState = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'\n  } = exhibit;\n  const responses = {\n    description: `# ${name}\n\n## –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞\n–≠–∫—Å–ø–æ–Ω–∞—Ç \"${name}\" –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑–µ—Ü ${category}, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –≤ ${year} –≥–æ–¥—É. –≠—Ç–æ—Ç –ø—Ä–µ–¥–º–µ—Ç —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω–æ–π —á–∞—Å—Ç—å—é –∫—É–ª—å—Ç—É—Ä–Ω–æ–≥–æ –Ω–∞—Å–ª–µ–¥–∏—è –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–π.\n\n## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏\n- **–ú–∞—Ç–µ—Ä–∏–∞–ª—ã:** ${Array.isArray(materials) ? materials.join(', ') : materials}\n- **–ì–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è:** ${year}\n- **–ö–∞—Ç–µ–≥–æ—Ä–∏—è:** ${category}\n- **–°–æ—Å—Ç–æ—è–Ω–∏–µ:** ${conservationState}\n\n## –ö—É–ª—å—Ç—É—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ\n–î–∞–Ω–Ω—ã–π —ç–∫—Å–ø–æ–Ω–∞—Ç –∏–º–µ–µ—Ç –±–æ–ª—å—à—É—é –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ü–µ–Ω–∏—Ç–µ–ª–µ–π –∏—Å–∫—É—Å—Å—Ç–≤–∞. –û–Ω –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Å–≤–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.\n\n## –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç\n–ü–æ–¥–æ–±–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –≤ —Ü–µ—Ä–µ–º–æ–Ω–∏–∞–ª—å–Ω—ã—Ö –∏–ª–∏ –±—ã—Ç–æ–≤—ã—Ö —Ü–µ–ª—è—Ö, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∏—Ö –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏ –ª—é–¥–µ–π —Ç–æ–π —ç–ø–æ—Ö–∏.\n\n*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ AI-–∞–Ω–∞–ª–∏–∑–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama —Å https://ollama.ai/*`,\n    conservation: `# –û—Ç—á–µ—Ç –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏\n\n## –≠–∫—Å–ø–æ–Ω–∞—Ç: ${name}\n## –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${category}\n## –ì–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è: ${year}\n\n## –û—Ü–µ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è: ${conservationState}\n\n### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é:\n\n1. **–£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è**\n   - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: 18-22¬∞C (¬±2¬∞C)\n   - –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å: 45-55%\n   - –û—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å: –Ω–µ –±–æ–ª–µ–µ 50 –ª—é–∫—Å\n   - –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ —Å–æ–ª–Ω–µ—á–Ω–æ–≥–æ —Å–≤–µ—Ç–∞\n\n2. **–†–µ–∂–∏–º –∫–æ–Ω—Ç—Ä–æ–ª—è**\n   - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π –æ—Å–º–æ—Ç—Ä\n   - –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ä–µ–¥—ã\n   - –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è —Ñ–æ—Ç–æ—Ñ–∏–∫—Å–∞—Ü–∏—è\n   - –ï–∂–µ–≥–æ–¥–Ω–∞—è –ø–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞\n\n3. **–ú–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏**\n   - –ò–∑–±–µ–≥–∞—Ç—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –ø–µ—Ä–µ–ø–∞–¥–æ–≤ >5¬∞C/—á–∞—Å\n   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ—Å–∫–∏—Å–ª–æ—Ç–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —É–ø–∞–∫–æ–≤–∫–∏\n   - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–∞–∫—Ç\n   - –•—Ä–∞–Ω–∏—Ç—å –≤ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ\n\n4. **–ü–ª–∞–Ω –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–∏**\n   - –ù–µ–¥–µ–ª—è 1-2: –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è\n   - –ù–µ–¥–µ–ª—è 3-4: –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞\n   - –ù–µ–¥–µ–ª—è 5-8: –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)\n   - –ù–µ–¥–µ–ª—è 9-12: –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞\n\n*–î–ª—è —Ç–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama*`,\n    art: `# –ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑\n\n## –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ: \"${name}\"\n\n### –°—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∞—Ç—Ä–∏–±—É—Ü–∏—è\n–≠–∫—Å–ø–æ–Ω–∞—Ç –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é ${category}, —á—Ç–æ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è—Ö —Ñ–æ—Ä–º—ã –∏ –¥–µ–∫–æ—Ä–∞.\n\n### –ö–æ–º–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑\n- **–ë–∞–ª–∞–Ω—Å:** –ì–∞—Ä–º–æ–Ω–∏—á–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤\n- **–†–∏—Ç–º:** –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –º–æ—Ç–∏–≤—ã —Å–æ–∑–¥–∞—é—Ç –µ–¥–∏–Ω—Å—Ç–≤–æ\n- **–ê–∫—Ü–µ–Ω—Ç—ã:** –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏–≤–ª–µ–∫–∞—é—Ç –≤–Ω–∏–º–∞–Ω–∏–µ\n\n### –ö–æ–ª–æ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ\n–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤–æ–π –ø–∞–ª–∏—Ç—Ä—ã, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ–π –¥–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ —Å–æ–∑–¥–∞–Ω–∏—è. –¢–æ–Ω–∞ –ø–æ–¥–æ–±—Ä–∞–Ω—ã —Å —É—á–µ—Ç–æ–º —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.\n\n### –¢–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è\n${materials.length > 0 ? `–ü—Ä–∏–º–µ–Ω–µ–Ω—ã —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã: ${Array.isArray(materials) ? materials.join(', ') : materials}` : '–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'}\n\n### –ò—Å—Ç–æ—Ä–∏–∫–æ-–∫—É–ª—å—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç\n–°–æ–∑–¥–∞–Ω –≤ ${year} –≥–æ–¥—É, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–µ—Ä–∏–æ–¥—É ${getHistoricalPeriod(year)}. –û—Ç—Ä–∞–∂–∞–µ—Ç —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Å–≤–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.\n\n### –ó–Ω–∞—á–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞\n–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å –∫–∞–∫ –ø—Ä–∏–º–µ—Ä ${category} –∏ –≤–Ω–æ—Å–∏—Ç –≤–∫–ª–∞–¥ –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∞–∑–≤–∏—Ç–∏—è —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–¥–∏—Ü–∏–π.\n\n*–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ AI-–∞–Ω–∞–ª–∏–∑–∞*`\n  };\n  return {\n    success: false,\n    content: responses[type] || responses.description,\n    model: 'demo',\n    time: 100,\n    tokens: 0,\n    type: type,\n    title: getAnalysisTitle(type) + ' (–¥–µ–º–æ)',\n    note: 'Ollama –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω.',\n    status: 'demo'\n  };\n};\nconst getFallbackResponse = (exhibit, type) => {\n  const demo = getDemoResponse(exhibit, type);\n  return demo.content;\n};\nconst getHistoricalPeriod = year => {\n  const y = parseInt(year);\n  if (isNaN(y)) return '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞';\n  if (y < -3000) return '–¥—Ä–µ–≤–Ω–µ–π—à–∏—Ö —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–π';\n  if (y < 500) return '–∞–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏';\n  if (y < 1500) return '—Å—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤—å—è';\n  if (y < 1800) return '—ç–ø–æ—Ö–∏ –í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è';\n  if (y < 1900) return '–ù–æ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏';\n  if (y < 2000) return '–º–æ–¥–µ—Ä–Ω–∏–∑–º–∞';\n  return '—Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∏—Å–∫—É—Å—Å—Ç–≤–∞';\n};\nexport const streamOllamaResponse = async (prompt, model = 'mistral', onChunk, onComplete) => {\n  try {\n    const response = await fetch(`${OLLAMA_API_URL}/generate`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        model,\n        prompt,\n        stream: true,\n        options: {\n          temperature: 0.7,\n          num_predict: 1000\n        }\n      })\n    });\n    if (!response.ok) {\n      throw new Error(`–û—à–∏–±–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞: ${response.status}`);\n    }\n    const reader = response.body.getReader();\n    const decoder = new TextDecoder();\n    let fullResponse = '';\n    while (true) {\n      const {\n        done,\n        value\n      } = await reader.read();\n      if (done) break;\n      const chunk = decoder.decode(value);\n      const lines = chunk.split('\\n').filter(line => line.trim());\n      for (const line of lines) {\n        try {\n          const data = JSON.parse(line);\n          if (data.response) {\n            fullResponse += data.response;\n            if (onChunk) {\n              onChunk(data.response, fullResponse);\n            }\n          }\n        } catch (e) {}\n      }\n    }\n    if (onComplete) {\n      onComplete(fullResponse);\n    }\n    return fullResponse;\n  } catch (error) {\n    console.error('–û—à–∏–±–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ Ollama:', error);\n    throw error;\n  }\n};\nexport default {\n  checkOllamaStatus,\n  analyzeWithOllama,\n  streamOllamaResponse\n};","map":{"version":3,"names":["OLLAMA_API_URL","checkOllamaStatus","_data$models","response","fetch","method","headers","timeout","ok","console","warn","status","available","models","message","error","data","json","length","details","analyzeWithOllama","exhibit","analysisType","_status$models$","startTime","Date","now","log","getDemoResponse","hasMistral","some","model","name","includes","modelToUse","prompt","generatePrompt","body","JSON","stringify","stream","options","temperature","top_p","top_k","num_predict","repeat_penalty","seed","system","getSystemPrompt","Error","statusText","endTime","processingTime","success","content","formatResponse","time","tokens","total_duration","Math","round","type","title","getAnalysisTitle","note","raw","getFallbackResponse","prompts","description","conservation","art","category","year","materials","conservationState","dimensions","location","value","materialsText","Array","isArray","join","dimensionsText","height","width","depth","locationText","hall","room","baseInfo","trim","cleaned","replace","titles","history","responses","getHistoricalPeriod","demo","y","parseInt","isNaN","streamOllamaResponse","onChunk","onComplete","reader","getReader","decoder","TextDecoder","fullResponse","done","read","chunk","decode","lines","split","filter","line","parse","e"],"sources":["C:/Users/user/React_museum/museum/client/src/components/ollamaService.js"],"sourcesContent":["\r\nconst OLLAMA_API_URL = 'http://localhost:11434/api';\r\n\r\nexport const checkOllamaStatus = async () => {\r\n  try {\r\n        \r\n    const response = await fetch(`${OLLAMA_API_URL}/tags`, {\r\n      method: 'GET',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      timeout: 3000 \r\n    });\r\n    \r\n    if (!response.ok) {\r\n      console.warn('‚ö†Ô∏è Ollama –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç, —Å—Ç–∞—Ç—É—Å:', response.status);\r\n      return {\r\n        available: false,\r\n        models: [],\r\n        message: 'Ollama –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω',\r\n        error: `HTTP ${response.status}`\r\n      };\r\n    }\r\n    \r\n    const data = await response.json();;\r\n    \r\n    return {\r\n      available: true,\r\n      models: data.models || [],\r\n      message: `–î–æ—Å—Ç—É–ø–Ω–æ –º–æ–¥–µ–ª–µ–π: ${data.models?.length || 0}`,\r\n      details: data.models\r\n    };\r\n  } catch (error) {\r\n    console.warn('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Ollama:', error.message);\r\n        \r\n    return {\r\n      available: false,\r\n      models: [],\r\n      message: 'Ollama –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å https://ollama.ai/',\r\n      error: error.message\r\n    };\r\n  }\r\n};\r\n\r\nexport const analyzeWithOllama = async (exhibit, analysisType = 'description') => {\r\n  const startTime = Date.now();\r\n  const status = await checkOllamaStatus();\r\n  \r\n  if (!status.available) {\r\n    console.log('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º (Ollama –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω)');\r\n    return getDemoResponse(exhibit, analysisType);\r\n  }\r\n  \r\n  const hasMistral = status.models.some(model => model.name.includes('mistral'));\r\n  const modelToUse = hasMistral ? 'mistral' : (status.models[0]?.name || 'mistral');\r\n  \r\n  \r\n  const prompt = generatePrompt(exhibit, analysisType);\r\n  \r\n  try {\r\n      \r\n    const response = await fetch(`${OLLAMA_API_URL}/generate`, {\r\n      method: 'POST',\r\n      headers: { \r\n        'Content-Type': 'application/json',\r\n        'Accept': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        model: modelToUse,\r\n        prompt: prompt,\r\n        stream: false,\r\n        options: {\r\n          temperature: 0.7, \r\n          top_p: 0.9,      \r\n          top_k: 40,     \r\n          num_predict: 100, \r\n          repeat_penalty: 1.1, \r\n          seed: 42       \r\n        },\r\n        system: getSystemPrompt(analysisType)\r\n      })\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`–û—à–∏–±–∫–∞ Ollama API: ${response.status} ${response.statusText}`);\r\n    }\r\n    \r\n    const data = await response.json();\r\n    const endTime = Date.now();\r\n    const processingTime = endTime - startTime;\r\n    \r\n    console.log(`‚úÖ AI –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ ${processingTime}–º—Å`);\r\n    \r\n    return {\r\n      success: true,\r\n      content: formatResponse(data.response, analysisType),\r\n      model: data.model,\r\n      time: processingTime,\r\n      tokens: data.total_duration ? Math.round(data.total_duration / 1000000) : 0,\r\n      type: analysisType,\r\n      title: getAnalysisTitle(analysisType),\r\n      note: `–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –º–æ–¥–µ–ª—å—é ${data.model} –∑–∞ ${processingTime}–º—Å`,\r\n      raw: data.response,\r\n      status: 'success'\r\n    };\r\n    \r\n  } catch (error) {\r\n    console.error('‚ùå –û—à–∏–±–∫–∞ AI –∞–Ω–∞–ª–∏–∑–∞:', error);\r\n    const endTime = Date.now();\r\n    \r\n    return {\r\n      success: false,\r\n      content: getFallbackResponse(exhibit, analysisType),\r\n      model: 'error',\r\n      time: endTime - startTime,\r\n      tokens: 0,\r\n      type: analysisType,\r\n      title: getAnalysisTitle(analysisType) + ' (–æ—à–∏–±–∫–∞)',\r\n      note: `–û—à–∏–±–∫–∞: ${error.message}. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω.`,\r\n      error: error.message,\r\n      status: 'error'\r\n    };\r\n  }\r\n};\r\n\r\nconst getSystemPrompt = (analysisType) => {\r\n  const prompts = {\r\n    description: `–¢—ã - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥ –∏ —ç–∫—Å–ø–µ—Ä—Ç –º—É–∑–µ—è. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - —Å–æ–∑–¥–∞–≤–∞—Ç—å —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ, \r\n–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –º—É–∑–µ–π–Ω—ã—Ö —ç–∫—Å–ø–æ–Ω–∞—Ç–æ–≤.`,\r\n    conservation: `–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–∏ –∏ —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –º—É–∑–µ–π–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π —Å 20-–ª–µ—Ç–Ω–∏–º –æ–ø—ã—Ç–æ–º..`,\r\n    art: `–¢—ã - –≤–µ–¥—É—â–∏–π –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥, —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞.\r\n–ü—Ä–æ–≤–æ–¥–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π.`\r\n  };  \r\n  return prompts[analysisType] || prompts.description;\r\n};\r\n\r\nconst generatePrompt = (exhibit, analysisType) => {\r\n  const { \r\n    name = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —ç–∫—Å–ø–æ–Ω–∞—Ç', \r\n    description = '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç',\r\n    category = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è',\r\n    year = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –≥–æ–¥',\r\n    materials = [],\r\n    conservationState = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',\r\n    dimensions = {},\r\n    location = {},\r\n    value = '–ù–µ –æ—Ü–µ–Ω–µ–Ω–æ'\r\n  } = exhibit;\r\n  \r\n  const materialsText = Array.isArray(materials) ? materials.join(', ') : materials;\r\n  const dimensionsText = dimensions ? `–í—ã—Å–æ—Ç–∞: ${dimensions.height || '?'}—Å–º, –®–∏—Ä–∏–Ω–∞: ${dimensions.width || '?'}—Å–º, –ì–ª—É–±–∏–Ω–∞: ${dimensions.depth || '?'}—Å–º` : '–ù–µ —É–∫–∞–∑–∞–Ω—ã';\r\n  const locationText = location ? `–ó–∞–ª: ${location.hall || '?'}, –ö–æ–º–Ω–∞—Ç–∞: ${location.room || '?'}` : '–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ';\r\n  \r\n  const baseInfo = `\r\n–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –≠–ö–°–ü–û–ù–ê–¢–ï:\r\n–ù–∞–∑–≤–∞–Ω–∏–µ: ${name}\r\n–û–ø–∏—Å–∞–Ω–∏–µ: ${description}\r\n`.trim();\r\n\r\n  switch (analysisType) {\r\n    case 'description':\r\n      return `${baseInfo}\r\n–°–æ–∑–¥–∞–π –ø–æ–¥—Ä–æ–±–Ω–æ–µ, —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –º—É–∑–µ–π–Ω–æ–≥–æ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞ –¥–ª—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π.\r\n–î–ª–∏–Ω–∞: –ø—Ä–∏–º–µ—Ä–Ω–æ 50-100 —Å–ª–æ–≤.`;\r\n    case 'conservation':\r\n      return `${baseInfo}\r\n–ü—Ä–æ–≤–µ–¥–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏ –∏ –¥–∞–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:\r\n1. –û—Ü–µ–Ω–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–æ—Ç 1 –¥–æ 10)\r\n2. –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∏—Å–∫–∏ –∏ —É–≥—Ä–æ–∑—ã.`;\r\n    case 'art':\r\n      return `${baseInfo}\r\n–ü—Ä–æ–≤–µ–¥–∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:\r\n1. –°–∏–º–≤–æ–ª–∏–∫–∞ –∏ —Å–º—ã—Å–ª–æ–≤–æ–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ\r\n2. –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å.`;\r\n    default:\r\n      return `${baseInfo}\r\n–°–¥–µ–ª–∞–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —ç—Ç–æ–≥–æ –º—É–∑–µ–π–Ω–æ–≥–æ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞.`;\r\n  }\r\n};\r\n\r\nconst formatResponse = (response, type) => {\r\n  \r\n  let cleaned = response\r\n    .replace(/^\\s+/, '')\r\n    .replace(/\\s+$/, '')\r\n    .replace(/\\n\\s*\\n\\s*\\n/g, '\\n\\n'); \r\n  \r\n  switch (type) {\r\n    case 'description':\r\n      if (!cleaned.includes('#') && !cleaned.includes('##')) {\r\n        cleaned = `# ${getAnalysisTitle(type)}\\n\\n${cleaned}`;\r\n      }\r\n      break;\r\n      \r\n    case 'conservation':\r\n      if (!cleaned.includes('##')) {\r\n       cleaned = `# –û—Ç—á–µ—Ç –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏\\n\\n${cleaned}`;\r\n      }\r\n      break;\r\n      \r\n    case 'art':\r\n      if (!cleaned.includes('##')) {\r\n        cleaned = `# –ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑\\n\\n${cleaned}`;\r\n      }\r\n      break;\r\n  }\r\n  \r\n  return cleaned;\r\n};\r\n\r\nconst getAnalysisTitle = (type) => {\r\n  const titles = {\r\n    description: 'üìù AI-–æ–ø–∏—Å–∞–Ω–∏–µ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞',\r\n    conservation: 'üõ°Ô∏è –ê–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏',\r\n    art: 'üé® –ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑',\r\n    history: 'üìú –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç'\r\n  };\r\n  return titles[type] || 'ü§ñ AI –∞–Ω–∞–ª–∏–∑';\r\n};\r\n\r\n\r\nconst getDemoResponse = (exhibit, type) => {\r\n  const { \r\n    name = '–≠–∫—Å–ø–æ–Ω–∞—Ç', \r\n    category = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è', \r\n    year = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –≥–æ–¥',\r\n    materials = [],\r\n    conservationState = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'\r\n  } = exhibit;\r\n  \r\n  const responses = {\r\n    description: `# ${name}\r\n\r\n## –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞\r\n–≠–∫—Å–ø–æ–Ω–∞—Ç \"${name}\" –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑–µ—Ü ${category}, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –≤ ${year} –≥–æ–¥—É. –≠—Ç–æ—Ç –ø—Ä–µ–¥–º–µ—Ç —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω–æ–π —á–∞—Å—Ç—å—é –∫—É–ª—å—Ç—É—Ä–Ω–æ–≥–æ –Ω–∞—Å–ª–µ–¥–∏—è –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–π.\r\n\r\n## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏\r\n- **–ú–∞—Ç–µ—Ä–∏–∞–ª—ã:** ${Array.isArray(materials) ? materials.join(', ') : materials}\r\n- **–ì–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è:** ${year}\r\n- **–ö–∞—Ç–µ–≥–æ—Ä–∏—è:** ${category}\r\n- **–°–æ—Å—Ç–æ—è–Ω–∏–µ:** ${conservationState}\r\n\r\n## –ö—É–ª—å—Ç—É—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ\r\n–î–∞–Ω–Ω—ã–π —ç–∫—Å–ø–æ–Ω–∞—Ç –∏–º–µ–µ—Ç –±–æ–ª—å—à—É—é –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ü–µ–Ω–∏—Ç–µ–ª–µ–π –∏—Å–∫—É—Å—Å—Ç–≤–∞. –û–Ω –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Å–≤–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.\r\n\r\n## –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç\r\n–ü–æ–¥–æ–±–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –≤ —Ü–µ—Ä–µ–º–æ–Ω–∏–∞–ª—å–Ω—ã—Ö –∏–ª–∏ –±—ã—Ç–æ–≤—ã—Ö —Ü–µ–ª—è—Ö, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∏—Ö –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏ –ª—é–¥–µ–π —Ç–æ–π —ç–ø–æ—Ö–∏.\r\n\r\n*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ AI-–∞–Ω–∞–ª–∏–∑–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama —Å https://ollama.ai/*`,\r\n\r\n    conservation: `# –û—Ç—á–µ—Ç –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏\r\n\r\n## –≠–∫—Å–ø–æ–Ω–∞—Ç: ${name}\r\n## –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${category}\r\n## –ì–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è: ${year}\r\n\r\n## –û—Ü–µ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è: ${conservationState}\r\n\r\n### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é:\r\n\r\n1. **–£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è**\r\n   - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: 18-22¬∞C (¬±2¬∞C)\r\n   - –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å: 45-55%\r\n   - –û—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å: –Ω–µ –±–æ–ª–µ–µ 50 –ª—é–∫—Å\r\n   - –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ —Å–æ–ª–Ω–µ—á–Ω–æ–≥–æ —Å–≤–µ—Ç–∞\r\n\r\n2. **–†–µ–∂–∏–º –∫–æ–Ω—Ç—Ä–æ–ª—è**\r\n   - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π –æ—Å–º–æ—Ç—Ä\r\n   - –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ä–µ–¥—ã\r\n   - –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è —Ñ–æ—Ç–æ—Ñ–∏–∫—Å–∞—Ü–∏—è\r\n   - –ï–∂–µ–≥–æ–¥–Ω–∞—è –ø–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞\r\n\r\n3. **–ú–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏**\r\n   - –ò–∑–±–µ–≥–∞—Ç—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –ø–µ—Ä–µ–ø–∞–¥–æ–≤ >5¬∞C/—á–∞—Å\r\n   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ—Å–∫–∏—Å–ª–æ—Ç–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —É–ø–∞–∫–æ–≤–∫–∏\r\n   - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–∞–∫—Ç\r\n   - –•—Ä–∞–Ω–∏—Ç—å –≤ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ\r\n\r\n4. **–ü–ª–∞–Ω –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–∏**\r\n   - –ù–µ–¥–µ–ª—è 1-2: –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è\r\n   - –ù–µ–¥–µ–ª—è 3-4: –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞\r\n   - –ù–µ–¥–µ–ª—è 5-8: –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)\r\n   - –ù–µ–¥–µ–ª—è 9-12: –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞\r\n\r\n*–î–ª—è —Ç–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama*`,\r\n\r\n    art: `# –ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑\r\n\r\n## –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ: \"${name}\"\r\n\r\n### –°—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∞—Ç—Ä–∏–±—É—Ü–∏—è\r\n–≠–∫—Å–ø–æ–Ω–∞—Ç –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é ${category}, —á—Ç–æ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è—Ö —Ñ–æ—Ä–º—ã –∏ –¥–µ–∫–æ—Ä–∞.\r\n\r\n### –ö–æ–º–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑\r\n- **–ë–∞–ª–∞–Ω—Å:** –ì–∞—Ä–º–æ–Ω–∏—á–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤\r\n- **–†–∏—Ç–º:** –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –º–æ—Ç–∏–≤—ã —Å–æ–∑–¥–∞—é—Ç –µ–¥–∏–Ω—Å—Ç–≤–æ\r\n- **–ê–∫—Ü–µ–Ω—Ç—ã:** –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏–≤–ª–µ–∫–∞—é—Ç –≤–Ω–∏–º–∞–Ω–∏–µ\r\n\r\n### –ö–æ–ª–æ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ\r\n–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤–æ–π –ø–∞–ª–∏—Ç—Ä—ã, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ–π –¥–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ —Å–æ–∑–¥–∞–Ω–∏—è. –¢–æ–Ω–∞ –ø–æ–¥–æ–±—Ä–∞–Ω—ã —Å —É—á–µ—Ç–æ–º —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.\r\n\r\n### –¢–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è\r\n${materials.length > 0 ? `–ü—Ä–∏–º–µ–Ω–µ–Ω—ã —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã: ${Array.isArray(materials) ? materials.join(', ') : materials}` : '–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'}\r\n\r\n### –ò—Å—Ç–æ—Ä–∏–∫–æ-–∫—É–ª—å—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç\r\n–°–æ–∑–¥–∞–Ω –≤ ${year} –≥–æ–¥—É, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–µ—Ä–∏–æ–¥—É ${getHistoricalPeriod(year)}. –û—Ç—Ä–∞–∂–∞–µ—Ç —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Å–≤–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.\r\n\r\n### –ó–Ω–∞—á–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞\r\n–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å –∫–∞–∫ –ø—Ä–∏–º–µ—Ä ${category} –∏ –≤–Ω–æ—Å–∏—Ç –≤–∫–ª–∞–¥ –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∞–∑–≤–∏—Ç–∏—è —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–¥–∏—Ü–∏–π.\r\n\r\n*–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ AI-–∞–Ω–∞–ª–∏–∑–∞*`\r\n  };\r\n  \r\n  return {\r\n    success: false,\r\n    content: responses[type] || responses.description,\r\n    model: 'demo',\r\n    time: 100,\r\n    tokens: 0,\r\n    type: type,\r\n    title: getAnalysisTitle(type) + ' (–¥–µ–º–æ)',\r\n    note: 'Ollama –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω.',\r\n    status: 'demo'\r\n  };\r\n};\r\n\r\nconst getFallbackResponse = (exhibit, type) => {\r\n  const demo = getDemoResponse(exhibit, type);\r\n  return demo.content;\r\n};\r\n\r\nconst getHistoricalPeriod = (year) => {\r\n  const y = parseInt(year);\r\n  if (isNaN(y)) return '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞';\r\n  if (y < -3000) return '–¥—Ä–µ–≤–Ω–µ–π—à–∏—Ö —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–π';\r\n  if (y < 500) return '–∞–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏';\r\n  if (y < 1500) return '—Å—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤—å—è';\r\n  if (y < 1800) return '—ç–ø–æ—Ö–∏ –í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è';\r\n  if (y < 1900) return '–ù–æ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏';\r\n  if (y < 2000) return '–º–æ–¥–µ—Ä–Ω–∏–∑–º–∞';\r\n  return '—Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∏—Å–∫—É—Å—Å—Ç–≤–∞';\r\n};\r\n\r\nexport const streamOllamaResponse = async (prompt, model = 'mistral', onChunk, onComplete) => {\r\n  try {\r\n    const response = await fetch(`${OLLAMA_API_URL}/generate`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({\r\n        model,\r\n        prompt,\r\n        stream: true,\r\n        options: {\r\n          temperature: 0.7,\r\n          num_predict: 1000\r\n        }\r\n      })\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`–û—à–∏–±–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞: ${response.status}`);\r\n    }\r\n    \r\n    const reader = response.body.getReader();\r\n    const decoder = new TextDecoder();\r\n    let fullResponse = '';\r\n    \r\n    while (true) {\r\n      const { done, value } = await reader.read();\r\n      if (done) break;\r\n      \r\n      const chunk = decoder.decode(value);\r\n      const lines = chunk.split('\\n').filter(line => line.trim());\r\n      \r\n      for (const line of lines) {\r\n        try {\r\n          const data = JSON.parse(line);\r\n          if (data.response) {\r\n            fullResponse += data.response;\r\n            if (onChunk) {\r\n              onChunk(data.response, fullResponse);\r\n            }\r\n          }\r\n        } catch (e) {\r\n         \r\n        }\r\n      }\r\n    }\r\n    \r\n    if (onComplete) {\r\n      onComplete(fullResponse);\r\n    }\r\n    \r\n    return fullResponse;\r\n  } catch (error) {\r\n    console.error('–û—à–∏–±–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ Ollama:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport default {\r\n  checkOllamaStatus,\r\n    analyzeWithOllama,\r\n  streamOllamaResponse  \r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}