{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\React_museum\\\\museum\\\\client\\\\src\\\\components\\\\GoogleAuthButton.js\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { useGoogleLogin } from '@react-oauth/google';\nimport { useAuth } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GoogleAuthButton = () => {\n  _s();\n  const {\n    loginWithGoogle,\n    addNotification\n  } = useAuth();\n  const handleSuccess = async response => {\n    try {\n      console.log('✅ Google OAuth успешен:', response);\n\n      // 1. Получаем access token\n      const googleAccessToken = response.access_token;\n\n      // 2. Отправляем токен на наш сервер для верификации\n      const serverResponse = await fetch('http://localhost:5000/api/auth/google', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          token: googleAccessToken\n        })\n      });\n      if (!serverResponse.ok) {\n        throw new Error('Ошибка сервера при авторизации');\n      }\n      const serverData = await serverResponse.json();\n      if (serverData.success) {\n        // 3. Получаем информацию о пользователе от Google\n        const userInfoResponse = await fetch('https://www.googleapis.com/oauth2/v3/userinfo', {\n          headers: {\n            'Authorization': `Bearer ${googleAccessToken}`\n          }\n        });\n        const userInfo = await userInfoResponse.json();\n\n        // 4. Объединяем данные\n        const userData = {\n          ...serverData.user,\n          googleId: userInfo.sub,\n          email: userInfo.email,\n          name: userInfo.name,\n          picture: userInfo.picture,\n          verified_email: userInfo.email_verified\n        };\n\n        // 5. Сохраняем в localStorage\n        localStorage.setItem('museumUser', JSON.stringify(userData));\n        localStorage.setItem('authToken', serverData.user.token);\n\n        // 6. Обновляем состояние\n        loginWithGoogle(userData);\n        addNotification(`Вход выполнен как ${userInfo.name}`, 'success');\n\n        // 7. Перенаправляем\n        window.location.href = '/';\n      } else {\n        throw new Error(serverData.message || 'Ошибка авторизации');\n      }\n    } catch (error) {\n      console.error('❌ Ошибка Google OAuth:', error);\n      addNotification(`Ошибка входа через Google: ${error.message}`, 'error');\n    }\n  };\n  const handleError = () => {\n    console.error('❌ Google OAuth ошибка');\n    addNotification('Ошибка авторизации через Google', 'error');\n  };\n  const login = useGoogleLogin({\n    onSuccess: handleSuccess,\n    onError: handleError,\n    scope: 'profile email' // запрашиваемые разрешения\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"google-auth-wrapper\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"google-divider\",\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"\\u0418\\u043B\\u0438 \\u0432\\u043E\\u0439\\u0434\\u0438\\u0442\\u0435 \\u0447\\u0435\\u0440\\u0435\\u0437 Google\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => login(),\n      className: \"google-login-button\",\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        gap: '10px',\n        padding: '12px 24px',\n        backgroundColor: '#4285F4',\n        color: 'white',\n        border: 'none',\n        borderRadius: '4px',\n        fontSize: '16px',\n        cursor: 'pointer',\n        width: '100%',\n        maxWidth: '300px',\n        margin: '0 auto',\n        fontWeight: '500'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        width: \"18\",\n        height: \"18\",\n        xmlns: \"http://www.w3.org/2000/svg\",\n        viewBox: \"0 0 48 48\",\n        children: [/*#__PURE__*/_jsxDEV(\"path\", {\n          fill: \"#EA4335\",\n          d: \"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          fill: \"#4285F4\",\n          d: \"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          fill: \"#FBBC05\",\n          d: \"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          fill: \"#34A853\",\n          d: \"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          fill: \"none\",\n          d: \"M0 0h48v48H0z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), \"\\u0412\\u043E\\u0439\\u0442\\u0438 \\u0447\\u0435\\u0440\\u0435\\u0437 Google\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"google-note\",\n      style: {\n        fontSize: '12px',\n        color: '#666',\n        marginTop: '10px',\n        textAlign: 'center'\n      },\n      children: \"\\u041C\\u044B \\u043D\\u0435 \\u043F\\u0435\\u0440\\u0435\\u0434\\u0430\\u0435\\u043C \\u0432\\u0430\\u0448\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u0442\\u0440\\u0435\\u0442\\u044C\\u0438\\u043C \\u043B\\u0438\\u0446\\u0430\\u043C\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n};\n_s(GoogleAuthButton, \"mKFAhTuAJrHa5SAO8WMnoTtt2oM=\", false, function () {\n  return [useAuth, useGoogleLogin];\n});\n_c = GoogleAuthButton;\nexport default GoogleAuthButton;\nvar _c;\n$RefreshReg$(_c, \"GoogleAuthButton\");","map":{"version":3,"names":["React","useGoogleLogin","useAuth","jsxDEV","_jsxDEV","GoogleAuthButton","_s","loginWithGoogle","addNotification","handleSuccess","response","console","log","googleAccessToken","access_token","serverResponse","fetch","method","headers","body","JSON","stringify","token","ok","Error","serverData","json","success","userInfoResponse","userInfo","userData","user","googleId","sub","email","name","picture","verified_email","email_verified","localStorage","setItem","window","location","href","message","error","handleError","login","onSuccess","onError","scope","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","style","display","alignItems","justifyContent","gap","padding","backgroundColor","color","border","borderRadius","fontSize","cursor","width","maxWidth","margin","fontWeight","height","xmlns","viewBox","fill","d","marginTop","textAlign","_c","$RefreshReg$"],"sources":["C:/Users/user/React_museum/museum/client/src/components/GoogleAuthButton.js"],"sourcesContent":["import React from 'react';\r\nimport { useGoogleLogin } from '@react-oauth/google';\r\nimport { useAuth } from './AuthContext';\r\n\r\nconst GoogleAuthButton = () => {\r\n  const { loginWithGoogle, addNotification } = useAuth();\r\n\r\n  const handleSuccess = async (response) => {\r\n    try {\r\n      console.log('✅ Google OAuth успешен:', response);\r\n      \r\n      // 1. Получаем access token\r\n      const googleAccessToken = response.access_token;\r\n      \r\n      // 2. Отправляем токен на наш сервер для верификации\r\n      const serverResponse = await fetch('http://localhost:5000/api/auth/google', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          token: googleAccessToken\r\n        })\r\n      });\r\n\r\n      if (!serverResponse.ok) {\r\n        throw new Error('Ошибка сервера при авторизации');\r\n      }\r\n\r\n      const serverData = await serverResponse.json();\r\n      \r\n      if (serverData.success) {\r\n        // 3. Получаем информацию о пользователе от Google\r\n        const userInfoResponse = await fetch('https://www.googleapis.com/oauth2/v3/userinfo', {\r\n          headers: {\r\n            'Authorization': `Bearer ${googleAccessToken}`\r\n          }\r\n        });\r\n        \r\n        const userInfo = await userInfoResponse.json();\r\n        \r\n        // 4. Объединяем данные\r\n        const userData = {\r\n          ...serverData.user,\r\n          googleId: userInfo.sub,\r\n          email: userInfo.email,\r\n          name: userInfo.name,\r\n          picture: userInfo.picture,\r\n          verified_email: userInfo.email_verified\r\n        };\r\n        \r\n        // 5. Сохраняем в localStorage\r\n        localStorage.setItem('museumUser', JSON.stringify(userData));\r\n        localStorage.setItem('authToken', serverData.user.token);\r\n        \r\n        // 6. Обновляем состояние\r\n        loginWithGoogle(userData);\r\n        addNotification(`Вход выполнен как ${userInfo.name}`, 'success');\r\n        \r\n        // 7. Перенаправляем\r\n        window.location.href = '/';\r\n        \r\n      } else {\r\n        throw new Error(serverData.message || 'Ошибка авторизации');\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('❌ Ошибка Google OAuth:', error);\r\n      addNotification(`Ошибка входа через Google: ${error.message}`, 'error');\r\n    }\r\n  };\r\n\r\n  const handleError = () => {\r\n    console.error('❌ Google OAuth ошибка');\r\n    addNotification('Ошибка авторизации через Google', 'error');\r\n  };\r\n\r\n  const login = useGoogleLogin({\r\n    onSuccess: handleSuccess,\r\n    onError: handleError,\r\n    scope: 'profile email', // запрашиваемые разрешения\r\n  });\r\n\r\n  return (\r\n    <div className=\"google-auth-wrapper\">\r\n      <div className=\"google-divider\">\r\n        <span>Или войдите через Google</span>\r\n      </div>\r\n      \r\n      <button \r\n        onClick={() => login()}\r\n        className=\"google-login-button\"\r\n        style={{\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          gap: '10px',\r\n          padding: '12px 24px',\r\n          backgroundColor: '#4285F4',\r\n          color: 'white',\r\n          border: 'none',\r\n          borderRadius: '4px',\r\n          fontSize: '16px',\r\n          cursor: 'pointer',\r\n          width: '100%',\r\n          maxWidth: '300px',\r\n          margin: '0 auto',\r\n          fontWeight: '500'\r\n        }}\r\n      >\r\n        <svg width=\"18\" height=\"18\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 48 48\">\r\n          <path fill=\"#EA4335\" d=\"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z\"/>\r\n          <path fill=\"#4285F4\" d=\"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z\"/>\r\n          <path fill=\"#FBBC05\" d=\"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z\"/>\r\n          <path fill=\"#34A853\" d=\"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z\"/>\r\n          <path fill=\"none\" d=\"M0 0h48v48H0z\"/>\r\n        </svg>\r\n        Войти через Google\r\n      </button>\r\n      \r\n      <p className=\"google-note\" style={{\r\n        fontSize: '12px',\r\n        color: '#666',\r\n        marginTop: '10px',\r\n        textAlign: 'center'\r\n      }}>\r\n        Мы не передаем ваши данные третьим лицам\r\n      </p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GoogleAuthButton;"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,cAAc,QAAQ,qBAAqB;AACpD,SAASC,OAAO,QAAQ,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExC,MAAMC,gBAAgB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC7B,MAAM;IAAEC,eAAe;IAAEC;EAAgB,CAAC,GAAGN,OAAO,CAAC,CAAC;EAEtD,MAAMO,aAAa,GAAG,MAAOC,QAAQ,IAAK;IACxC,IAAI;MACFC,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAEF,QAAQ,CAAC;;MAEhD;MACA,MAAMG,iBAAiB,GAAGH,QAAQ,CAACI,YAAY;;MAE/C;MACA,MAAMC,cAAc,GAAG,MAAMC,KAAK,CAAC,uCAAuC,EAAE;QAC1EC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE;QAClB,CAAC;QACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UACnBC,KAAK,EAAET;QACT,CAAC;MACH,CAAC,CAAC;MAEF,IAAI,CAACE,cAAc,CAACQ,EAAE,EAAE;QACtB,MAAM,IAAIC,KAAK,CAAC,gCAAgC,CAAC;MACnD;MAEA,MAAMC,UAAU,GAAG,MAAMV,cAAc,CAACW,IAAI,CAAC,CAAC;MAE9C,IAAID,UAAU,CAACE,OAAO,EAAE;QACtB;QACA,MAAMC,gBAAgB,GAAG,MAAMZ,KAAK,CAAC,+CAA+C,EAAE;UACpFE,OAAO,EAAE;YACP,eAAe,EAAE,UAAUL,iBAAiB;UAC9C;QACF,CAAC,CAAC;QAEF,MAAMgB,QAAQ,GAAG,MAAMD,gBAAgB,CAACF,IAAI,CAAC,CAAC;;QAE9C;QACA,MAAMI,QAAQ,GAAG;UACf,GAAGL,UAAU,CAACM,IAAI;UAClBC,QAAQ,EAAEH,QAAQ,CAACI,GAAG;UACtBC,KAAK,EAAEL,QAAQ,CAACK,KAAK;UACrBC,IAAI,EAAEN,QAAQ,CAACM,IAAI;UACnBC,OAAO,EAAEP,QAAQ,CAACO,OAAO;UACzBC,cAAc,EAAER,QAAQ,CAACS;QAC3B,CAAC;;QAED;QACAC,YAAY,CAACC,OAAO,CAAC,YAAY,EAAEpB,IAAI,CAACC,SAAS,CAACS,QAAQ,CAAC,CAAC;QAC5DS,YAAY,CAACC,OAAO,CAAC,WAAW,EAAEf,UAAU,CAACM,IAAI,CAACT,KAAK,CAAC;;QAExD;QACAf,eAAe,CAACuB,QAAQ,CAAC;QACzBtB,eAAe,CAAC,qBAAqBqB,QAAQ,CAACM,IAAI,EAAE,EAAE,SAAS,CAAC;;QAEhE;QACAM,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,GAAG;MAE5B,CAAC,MAAM;QACL,MAAM,IAAInB,KAAK,CAACC,UAAU,CAACmB,OAAO,IAAI,oBAAoB,CAAC;MAC7D;IAEF,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdlC,OAAO,CAACkC,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;MAC9CrC,eAAe,CAAC,8BAA8BqC,KAAK,CAACD,OAAO,EAAE,EAAE,OAAO,CAAC;IACzE;EACF,CAAC;EAED,MAAME,WAAW,GAAGA,CAAA,KAAM;IACxBnC,OAAO,CAACkC,KAAK,CAAC,uBAAuB,CAAC;IACtCrC,eAAe,CAAC,iCAAiC,EAAE,OAAO,CAAC;EAC7D,CAAC;EAED,MAAMuC,KAAK,GAAG9C,cAAc,CAAC;IAC3B+C,SAAS,EAAEvC,aAAa;IACxBwC,OAAO,EAAEH,WAAW;IACpBI,KAAK,EAAE,eAAe,CAAE;EAC1B,CAAC,CAAC;EAEF,oBACE9C,OAAA;IAAK+C,SAAS,EAAC,qBAAqB;IAAAC,QAAA,gBAClChD,OAAA;MAAK+C,SAAS,EAAC,gBAAgB;MAAAC,QAAA,eAC7BhD,OAAA;QAAAgD,QAAA,EAAM;MAAwB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAClC,CAAC,eAENpD,OAAA;MACEqD,OAAO,EAAEA,CAAA,KAAMV,KAAK,CAAC,CAAE;MACvBI,SAAS,EAAC,qBAAqB;MAC/BO,KAAK,EAAE;QACLC,OAAO,EAAE,MAAM;QACfC,UAAU,EAAE,QAAQ;QACpBC,cAAc,EAAE,QAAQ;QACxBC,GAAG,EAAE,MAAM;QACXC,OAAO,EAAE,WAAW;QACpBC,eAAe,EAAE,SAAS;QAC1BC,KAAK,EAAE,OAAO;QACdC,MAAM,EAAE,MAAM;QACdC,YAAY,EAAE,KAAK;QACnBC,QAAQ,EAAE,MAAM;QAChBC,MAAM,EAAE,SAAS;QACjBC,KAAK,EAAE,MAAM;QACbC,QAAQ,EAAE,OAAO;QACjBC,MAAM,EAAE,QAAQ;QAChBC,UAAU,EAAE;MACd,CAAE;MAAArB,QAAA,gBAEFhD,OAAA;QAAKkE,KAAK,EAAC,IAAI;QAACI,MAAM,EAAC,IAAI;QAACC,KAAK,EAAC,4BAA4B;QAACC,OAAO,EAAC,WAAW;QAAAxB,QAAA,gBAChFhD,OAAA;UAAMyE,IAAI,EAAC,SAAS;UAACC,CAAC,EAAC;QAAyI;UAAAzB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAC,CAAC,eAClKpD,OAAA;UAAMyE,IAAI,EAAC,SAAS;UAACC,CAAC,EAAC;QAA2H;UAAAzB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAC,CAAC,eACpJpD,OAAA;UAAMyE,IAAI,EAAC,SAAS;UAACC,CAAC,EAAC;QAAkI;UAAAzB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAC,CAAC,eAC3JpD,OAAA;UAAMyE,IAAI,EAAC,SAAS;UAACC,CAAC,EAAC;QAA6I;UAAAzB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAC,CAAC,eACtKpD,OAAA;UAAMyE,IAAI,EAAC,MAAM;UAACC,CAAC,EAAC;QAAe;UAAAzB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAClC,CAAC,wEAER;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eAETpD,OAAA;MAAG+C,SAAS,EAAC,aAAa;MAACO,KAAK,EAAE;QAChCU,QAAQ,EAAE,MAAM;QAChBH,KAAK,EAAE,MAAM;QACbc,SAAS,EAAE,MAAM;QACjBC,SAAS,EAAE;MACb,CAAE;MAAA5B,QAAA,EAAC;IAEH;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACD,CAAC;AAEV,CAAC;AAAClD,EAAA,CA9HID,gBAAgB;EAAA,QACyBH,OAAO,EAwEtCD,cAAc;AAAA;AAAAgF,EAAA,GAzExB5E,gBAAgB;AAgItB,eAAeA,gBAAgB;AAAC,IAAA4E,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}