{"ast":null,"code":"// src/services/ollamaService.js\n/**\r\n * –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Ollama AI API\r\n * –ú–æ–¥–µ–ª—å: mistral (–ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä—É—Å—Å–∫–∏–º —è–∑—ã–∫–æ–º)\r\n * –¢—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∏ –∑–∞–ø—É—â–µ–Ω–Ω—ã–π Ollama: https://ollama.ai/\r\n * –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–¥–µ–ª—å: `ollama run mistral`\r\n */\n\nconst OLLAMA_API_URL = 'http://localhost:11434/api';\n\n/**\r\n * –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Ollama –∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π\r\n */\nexport const checkOllamaStatus = async () => {\n  try {\n    var _data$models, _data$models2;\n    console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Ollama...');\n    const response = await fetch(`${OLLAMA_API_URL}/tags`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      timeout: 3000 // 3 —Å–µ–∫—É–Ω–¥—ã —Ç–∞–π–º–∞—É—Ç\n    });\n    if (!response.ok) {\n      console.warn('‚ö†Ô∏è Ollama –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç, —Å—Ç–∞—Ç—É—Å:', response.status);\n      return {\n        available: false,\n        models: [],\n        message: 'Ollama –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω',\n        error: `HTTP ${response.status}`\n      };\n    }\n    const data = await response.json();\n    console.log('‚úÖ Ollama –¥–æ—Å—Ç—É–ø–µ–Ω, –º–æ–¥–µ–ª–∏:', (_data$models = data.models) === null || _data$models === void 0 ? void 0 : _data$models.map(m => m.name));\n    return {\n      available: true,\n      models: data.models || [],\n      message: `–î–æ—Å—Ç—É–ø–Ω–æ –º–æ–¥–µ–ª–µ–π: ${((_data$models2 = data.models) === null || _data$models2 === void 0 ? void 0 : _data$models2.length) || 0}`,\n      details: data.models\n    };\n  } catch (error) {\n    console.warn('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Ollama:', error.message);\n\n    // –ü–æ–ª–µ–∑–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n    console.log(`\nüìã –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –£–°–¢–ê–ù–û–í–ö–ï OLLAMA:\n1. –°–∫–∞—á–∞–π—Ç–µ Ollama: https://ollama.ai/download\n2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ\n3. –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:\n   ollama run mistral\n4. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏ (‚âà4GB)\n5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ\n\nüí° –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ Ollama —Ä–∞–±–æ—Ç–∞–µ—Ç:\n   curl http://localhost:11434/api/tags\n    `);\n    return {\n      available: false,\n      models: [],\n      message: 'Ollama –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å https://ollama.ai/',\n      error: error.message,\n      instructions: ['1. –°–∫–∞—á–∞–π—Ç–µ Ollama: https://ollama.ai/download', '2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ', '3. –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ: ollama run mistral', '4. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏', '5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ']\n    };\n  }\n};\n\n/**\r\n * –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π\r\n */\nexport const getAvailableModels = async () => {\n  try {\n    const status = await checkOllamaStatus();\n    if (status.available) {\n      return status.models.map(model => model.name);\n    }\n    return ['mistral', 'llama2', 'vicuna']; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\n  } catch (error) {\n    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π:', error);\n    return ['mistral'];\n  }\n};\n\n/**\r\n * –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞ —á–µ—Ä–µ–∑ Ollama\r\n */\nexport const analyzeWithOllama = async (exhibit, analysisType = 'description') => {\n  var _status$models$;\n  const startTime = Date.now();\n  console.log(`ü§ñ –ó–∞–ø—É—Å–∫ AI –∞–Ω–∞–ª–∏–∑–∞ (${analysisType}) –¥–ª—è:`, exhibit.name);\n\n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Ollama\n  const status = await checkOllamaStatus();\n  if (!status.available) {\n    console.log('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º (Ollama –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω)');\n    return getDemoResponse(exhibit, analysisType);\n  }\n\n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –º–æ–¥–µ–ª—å mistral\n  const hasMistral = status.models.some(model => model.name.includes('mistral'));\n  const modelToUse = hasMistral ? 'mistral' : ((_status$models$ = status.models[0]) === null || _status$models$ === void 0 ? void 0 : _status$models$.name) || 'mistral';\n  console.log(`üìù –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å: ${modelToUse}`);\n\n  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –∞–Ω–∞–ª–∏–∑–∞\n  const prompt = generatePrompt(exhibit, analysisType);\n  try {\n    console.log('üì° –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ Ollama...');\n    const response = await fetch(`${OLLAMA_API_URL}/generate`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      body: JSON.stringify({\n        model: modelToUse,\n        prompt: prompt,\n        stream: false,\n        options: {\n          temperature: 0.7,\n          // –ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å (0-1)\n          top_p: 0.9,\n          // –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –æ—Ç–≤–µ—Ç–æ–≤\n          top_k: 40,\n          // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è\n          num_predict: 800,\n          // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞\n          repeat_penalty: 1.1,\n          // –®—Ç—Ä–∞—Ñ –∑–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è\n          seed: 42 // –î–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏\n        },\n        system: getSystemPrompt(analysisType)\n      })\n    });\n    if (!response.ok) {\n      throw new Error(`–û—à–∏–±–∫–∞ Ollama API: ${response.status} ${response.statusText}`);\n    }\n    const data = await response.json();\n    const endTime = Date.now();\n    const processingTime = endTime - startTime;\n    console.log(`‚úÖ AI –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ ${processingTime}–º—Å`);\n    return {\n      success: true,\n      content: formatResponse(data.response, analysisType),\n      model: data.model,\n      time: processingTime,\n      tokens: data.total_duration ? Math.round(data.total_duration / 1000000) : 0,\n      type: analysisType,\n      title: getAnalysisTitle(analysisType),\n      note: `–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –º–æ–¥–µ–ª—å—é ${data.model} –∑–∞ ${processingTime}–º—Å`,\n      raw: data.response,\n      status: 'success'\n    };\n  } catch (error) {\n    console.error('‚ùå –û—à–∏–±–∫–∞ AI –∞–Ω–∞–ª–∏–∑–∞:', error);\n    const endTime = Date.now();\n    return {\n      success: false,\n      content: getFallbackResponse(exhibit, analysisType),\n      model: 'error',\n      time: endTime - startTime,\n      tokens: 0,\n      type: analysisType,\n      title: getAnalysisTitle(analysisType) + ' (–æ—à–∏–±–∫–∞)',\n      note: `–û—à–∏–±–∫–∞: ${error.message}. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω.`,\n      error: error.message,\n      status: 'error'\n    };\n  }\n};\n\n/**\r\n * –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞–Ω–∞–ª–∏–∑–∞\r\n */\nconst getSystemPrompt = analysisType => {\n  const prompts = {\n    description: `–¢—ã - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥ –∏ —ç–∫—Å–ø–µ—Ä—Ç –º—É–∑–µ—è. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - —Å–æ–∑–¥–∞–≤–∞—Ç—å —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ, \n–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –º—É–∑–µ–π–Ω—ã—Ö —ç–∫—Å–ø–æ–Ω–∞—Ç–æ–≤. \n–ü–∏—à–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –∏—Å–ø–æ–ª—å–∑—É–π –Ω–∞—É—á–Ω—ã–π –Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã–π —Å—Ç–∏–ª—å.\n–§–æ—Ä–º–∞—Ç: –ó–∞–≥–æ–ª–æ–≤–æ–∫, –∫—Ä–∞—Ç–∫–æ–µ –≤–≤–µ–¥–µ–Ω–∏–µ, –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã —Å –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏, –∑–∞–∫–ª—é—á–µ–Ω–∏–µ.\n–î–æ–±–∞–≤—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç.`,\n    conservation: `–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–∏ –∏ —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –º—É–∑–µ–π–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π —Å 20-–ª–µ—Ç–Ω–∏–º –æ–ø—ã—Ç–æ–º.\n–î–∞–≤–∞–π —Ç–æ—á–Ω—ã–µ, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é —ç–∫—Å–ø–æ–Ω–∞—Ç–æ–≤.\n–ò—Å–ø–æ–ª—å–∑—É–π –Ω–∞—É—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –Ω–æ –æ–±—ä—è—Å–Ω—è–π –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º.\n–§–æ—Ä–º–∞—Ç: –û—Ü–µ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è, —Ä–∏—Å–∫–∏, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ö—Ä–∞–Ω–µ–Ω–∏—é, –ø–ª–∞–Ω –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–∏.`,\n    art: `–¢—ã - –≤–µ–¥—É—â–∏–π –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥, —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞.\n–ü—Ä–æ–≤–æ–¥–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π.\n–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–π: —Å—Ç–∏–ª—å, —Ç–µ—Ö–Ω–∏–∫—É, –∫–æ–º–ø–æ–∑–∏—Ü–∏—é, —Ü–≤–µ—Ç, –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∑–Ω–∞—á–µ–Ω–∏–µ.\n–ü–∏—à–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —à–∏—Ä–æ–∫–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏.`\n  };\n  return prompts[analysisType] || prompts.description;\n};\n\n/**\r\n * –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö —ç–∫—Å–ø–æ–Ω–∞—Ç–∞\r\n */\nconst generatePrompt = (exhibit, analysisType) => {\n  const {\n    name = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —ç–∫—Å–ø–æ–Ω–∞—Ç',\n    description = '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç',\n    category = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è',\n    year = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –≥–æ–¥',\n    materials = [],\n    conservationState = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',\n    dimensions = {},\n    location = {},\n    value = '–ù–µ –æ—Ü–µ–Ω–µ–Ω–æ'\n  } = exhibit;\n  const materialsText = Array.isArray(materials) ? materials.join(', ') : materials;\n  const dimensionsText = dimensions ? `–í—ã—Å–æ—Ç–∞: ${dimensions.height || '?'}—Å–º, –®–∏—Ä–∏–Ω–∞: ${dimensions.width || '?'}—Å–º, –ì–ª—É–±–∏–Ω–∞: ${dimensions.depth || '?'}—Å–º` : '–ù–µ —É–∫–∞–∑–∞–Ω—ã';\n  const locationText = location ? `–ó–∞–ª: ${location.hall || '?'}, –ö–æ–º–Ω–∞—Ç–∞: ${location.room || '?'}` : '–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ';\n  const baseInfo = `\n–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –≠–ö–°–ü–û–ù–ê–¢–ï:\n–ù–∞–∑–≤–∞–Ω–∏–µ: ${name}\n–û–ø–∏—Å–∞–Ω–∏–µ: ${description}\n–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${category}\n–ì–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è: ${year}\n–ú–∞—Ç–µ—Ä–∏–∞–ª—ã: ${materialsText}\n–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏: ${conservationState}\n–†–∞–∑–º–µ—Ä—ã: ${dimensionsText}\n–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –º—É–∑–µ–µ: ${locationText}\n–¶–µ–Ω–Ω–æ—Å—Ç—å: ${value}\n`.trim();\n  switch (analysisType) {\n    case 'description':\n      return `${baseInfo}\n\n–°–æ–∑–¥–∞–π –ø–æ–¥—Ä–æ–±–Ω–æ–µ, —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –º—É–∑–µ–π–Ω–æ–≥–æ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞ –¥–ª—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π.\n–í–∫–ª—é—á–∏:\n1. –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ\n2. –¢–µ—Ö–Ω–∏–∫—É –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã\n3. –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏\n4. –ö—É–ª—å—Ç—É—Ä–Ω–æ–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ\n5. –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã\n\n–ü–∏—à–∏ –∂–∏–≤—ã–º, engaging —è–∑—ã–∫–æ–º, –Ω–æ –æ—Å—Ç–∞–≤–∞–π—Å—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º.\n–î–ª–∏–Ω–∞: –ø—Ä–∏–º–µ—Ä–Ω–æ 300-400 —Å–ª–æ–≤.`;\n    case 'conservation':\n      return `${baseInfo}\n\n–ü—Ä–æ–≤–µ–¥–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏ –∏ –¥–∞–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:\n1. –û—Ü–µ–Ω–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–æ—Ç 1 –¥–æ 10)\n2. –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∏—Å–∫–∏ –∏ —É–≥—Ä–æ–∑—ã\n3. –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, —Å–≤–µ—Ç)\n4. –ü–ª–∞–Ω –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–æ–Ω–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π\n5. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)\n6. –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–æ–∫\n\n–ë—É–¥—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∏ –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–º.`;\n    case 'art':\n      return `${baseInfo}\n\n–ü—Ä–æ–≤–µ–¥–∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:\n1. –°—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∏ –ø–µ—Ä–∏–æ–¥\n2. –ê–Ω–∞–ª–∏–∑ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏, —Ü–≤–µ—Ç–∞, —Ñ–æ—Ä–º—ã\n3. –¢–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ\n4. –°–∏–º–≤–æ–ª–∏–∫–∞ –∏ —Å–º—ã—Å–ª–æ–≤–æ–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ\n5. –ò—Å—Ç–æ—Ä–∏–∫–æ-–∫—É–ª—å—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç\n6. –ú–µ—Å—Ç–æ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞\n7. –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å\n\n–ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é, –Ω–æ –æ–±—ä—è—Å–Ω—è–π –ø–æ–Ω—è—Ç–Ω–æ.`;\n    default:\n      return `${baseInfo}\n      \n–°–¥–µ–ª–∞–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —ç—Ç–æ–≥–æ –º—É–∑–µ–π–Ω–æ–≥–æ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞.`;\n  }\n};\n\n/**\r\n * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –æ—Ç AI\r\n */\nconst formatResponse = (response, type) => {\n  // –û—á–∏—â–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç –ª–∏—à–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤\n  let cleaned = response.replace(/^\\s+/, '').replace(/\\s+$/, '').replace(/\\n\\s*\\n\\s*\\n/g, '\\n\\n'); // –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏\n\n  // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞\n  switch (type) {\n    case 'description':\n      if (!cleaned.includes('#') && !cleaned.includes('##')) {\n        cleaned = `# ${getAnalysisTitle(type)}\\n\\n${cleaned}`;\n      }\n      break;\n    case 'conservation':\n      if (!cleaned.includes('##')) {\n        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –æ—Ç—á–µ—Ç–∞ –æ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏\n        cleaned = `# –û—Ç—á–µ—Ç –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏\\n\\n${cleaned}`;\n      }\n      break;\n    case 'art':\n      if (!cleaned.includes('##')) {\n        cleaned = `# –ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑\\n\\n${cleaned}`;\n      }\n      break;\n  }\n  return cleaned;\n};\n\n/**\r\n * –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞–Ω–∞–ª–∏–∑–∞\r\n */\nconst getAnalysisTitle = type => {\n  const titles = {\n    description: 'üìù AI-–æ–ø–∏—Å–∞–Ω–∏–µ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞',\n    conservation: 'üõ°Ô∏è –ê–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏',\n    art: 'üé® –ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑',\n    history: 'üìú –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç'\n  };\n  return titles[type] || 'ü§ñ AI –∞–Ω–∞–ª–∏–∑';\n};\n\n/**\r\n * –î–µ–º–æ-–æ—Ç–≤–µ—Ç—ã –¥–ª—è —Å–ª—É—á–∞—è, –∫–æ–≥–¥–∞ Ollama –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω\r\n */\nconst getDemoResponse = (exhibit, type) => {\n  const {\n    name = '–≠–∫—Å–ø–æ–Ω–∞—Ç',\n    category = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è',\n    year = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –≥–æ–¥',\n    materials = [],\n    conservationState = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'\n  } = exhibit;\n  const responses = {\n    description: `# ${name}\n\n## –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞\n–≠–∫—Å–ø–æ–Ω–∞—Ç \"${name}\" –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑–µ—Ü ${category}, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –≤ ${year} –≥–æ–¥—É. –≠—Ç–æ—Ç –ø—Ä–µ–¥–º–µ—Ç —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω–æ–π —á–∞—Å—Ç—å—é –∫—É–ª—å—Ç—É—Ä–Ω–æ–≥–æ –Ω–∞—Å–ª–µ–¥–∏—è –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–π.\n\n## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏\n- **–ú–∞—Ç–µ—Ä–∏–∞–ª—ã:** ${Array.isArray(materials) ? materials.join(', ') : materials}\n- **–ì–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è:** ${year}\n- **–ö–∞—Ç–µ–≥–æ—Ä–∏—è:** ${category}\n- **–°–æ—Å—Ç–æ—è–Ω–∏–µ:** ${conservationState}\n\n## –ö—É–ª—å—Ç—É—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ\n–î–∞–Ω–Ω—ã–π —ç–∫—Å–ø–æ–Ω–∞—Ç –∏–º–µ–µ—Ç –±–æ–ª—å—à—É—é –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ü–µ–Ω–∏—Ç–µ–ª–µ–π –∏—Å–∫—É—Å—Å—Ç–≤–∞. –û–Ω –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Å–≤–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.\n\n## –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç\n–ü–æ–¥–æ–±–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –≤ —Ü–µ—Ä–µ–º–æ–Ω–∏–∞–ª—å–Ω—ã—Ö –∏–ª–∏ –±—ã—Ç–æ–≤—ã—Ö —Ü–µ–ª—è—Ö, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∏—Ö –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏ –ª—é–¥–µ–π —Ç–æ–π —ç–ø–æ—Ö–∏.\n\n*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ AI-–∞–Ω–∞–ª–∏–∑–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama —Å https://ollama.ai/*`,\n    conservation: `# –û—Ç—á–µ—Ç –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏\n\n## –≠–∫—Å–ø–æ–Ω–∞—Ç: ${name}\n## –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${category}\n## –ì–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è: ${year}\n\n## –û—Ü–µ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è: ${conservationState}\n\n### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é:\n\n1. **–£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è**\n   - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: 18-22¬∞C (¬±2¬∞C)\n   - –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å: 45-55%\n   - –û—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å: –Ω–µ –±–æ–ª–µ–µ 50 –ª—é–∫—Å\n   - –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ —Å–æ–ª–Ω–µ—á–Ω–æ–≥–æ —Å–≤–µ—Ç–∞\n\n2. **–†–µ–∂–∏–º –∫–æ–Ω—Ç—Ä–æ–ª—è**\n   - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π –æ—Å–º–æ—Ç—Ä\n   - –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ä–µ–¥—ã\n   - –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è —Ñ–æ—Ç–æ—Ñ–∏–∫—Å–∞—Ü–∏—è\n   - –ï–∂–µ–≥–æ–¥–Ω–∞—è –ø–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞\n\n3. **–ú–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏**\n   - –ò–∑–±–µ–≥–∞—Ç—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –ø–µ—Ä–µ–ø–∞–¥–æ–≤ >5¬∞C/—á–∞—Å\n   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ—Å–∫–∏—Å–ª–æ—Ç–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —É–ø–∞–∫–æ–≤–∫–∏\n   - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–∞–∫—Ç\n   - –•—Ä–∞–Ω–∏—Ç—å –≤ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ\n\n4. **–ü–ª–∞–Ω –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–∏**\n   - –ù–µ–¥–µ–ª—è 1-2: –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è\n   - –ù–µ–¥–µ–ª—è 3-4: –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞\n   - –ù–µ–¥–µ–ª—è 5-8: –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)\n   - –ù–µ–¥–µ–ª—è 9-12: –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞\n\n*–î–ª—è —Ç–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama*`,\n    art: `# –ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑\n\n## –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ: \"${name}\"\n\n### –°—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∞—Ç—Ä–∏–±—É—Ü–∏—è\n–≠–∫—Å–ø–æ–Ω–∞—Ç –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é ${category}, —á—Ç–æ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è—Ö —Ñ–æ—Ä–º—ã –∏ –¥–µ–∫–æ—Ä–∞.\n\n### –ö–æ–º–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑\n- **–ë–∞–ª–∞–Ω—Å:** –ì–∞—Ä–º–æ–Ω–∏—á–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤\n- **–†–∏—Ç–º:** –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –º–æ—Ç–∏–≤—ã —Å–æ–∑–¥–∞—é—Ç –µ–¥–∏–Ω—Å—Ç–≤–æ\n- **–ê–∫—Ü–µ–Ω—Ç—ã:** –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏–≤–ª–µ–∫–∞—é—Ç –≤–Ω–∏–º–∞–Ω–∏–µ\n\n### –ö–æ–ª–æ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ\n–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤–æ–π –ø–∞–ª–∏—Ç—Ä—ã, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ–π –¥–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ —Å–æ–∑–¥–∞–Ω–∏—è. –¢–æ–Ω–∞ –ø–æ–¥–æ–±—Ä–∞–Ω—ã —Å —É—á–µ—Ç–æ–º —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.\n\n### –¢–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è\n${materials.length > 0 ? `–ü—Ä–∏–º–µ–Ω–µ–Ω—ã —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã: ${Array.isArray(materials) ? materials.join(', ') : materials}` : '–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'}\n\n### –ò—Å—Ç–æ—Ä–∏–∫–æ-–∫—É–ª—å—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç\n–°–æ–∑–¥–∞–Ω –≤ ${year} –≥–æ–¥—É, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–µ—Ä–∏–æ–¥—É ${getHistoricalPeriod(year)}. –û—Ç—Ä–∞–∂–∞–µ—Ç —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Å–≤–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.\n\n### –ó–Ω–∞—á–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞\n–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å –∫–∞–∫ –ø—Ä–∏–º–µ—Ä ${category} –∏ –≤–Ω–æ—Å–∏—Ç –≤–∫–ª–∞–¥ –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∞–∑–≤–∏—Ç–∏—è —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–¥–∏—Ü–∏–π.\n\n*–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ AI-–∞–Ω–∞–ª–∏–∑–∞*`\n  };\n  return {\n    success: false,\n    content: responses[type] || responses.description,\n    model: 'demo',\n    time: 100,\n    tokens: 0,\n    type: type,\n    title: getAnalysisTitle(type) + ' (–¥–µ–º–æ)',\n    note: 'Ollama –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: https://ollama.ai/\\n–ó–∞–ø—É—Å—Ç–∏—Ç–µ: ollama run mistral',\n    status: 'demo'\n  };\n};\n\n/**\r\n * –§–æ–ª–±—ç–∫ –æ—Ç–≤–µ—Ç (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö)\r\n */\nconst getFallbackResponse = (exhibit, type) => {\n  const demo = getDemoResponse(exhibit, type);\n  return demo.content;\n};\n\n/**\r\n * –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞\r\n */\nconst getHistoricalPeriod = year => {\n  const y = parseInt(year);\n  if (isNaN(y)) return '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞';\n  if (y < -3000) return '–¥—Ä–µ–≤–Ω–µ–π—à–∏—Ö —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–π';\n  if (y < 500) return '–∞–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏';\n  if (y < 1500) return '—Å—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤—å—è';\n  if (y < 1800) return '—ç–ø–æ—Ö–∏ –í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è';\n  if (y < 1900) return '–ù–æ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏';\n  if (y < 2000) return '–º–æ–¥–µ—Ä–Ω–∏–∑–º–∞';\n  return '—Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∏—Å–∫—É—Å—Å—Ç–≤–∞';\n};\n\n/**\r\n * –°—Ç—Ä–∏–º–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)\r\n */\nexport const streamOllamaResponse = async (prompt, model = 'mistral', onChunk, onComplete) => {\n  try {\n    const response = await fetch(`${OLLAMA_API_URL}/generate`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        model,\n        prompt,\n        stream: true,\n        options: {\n          temperature: 0.7,\n          num_predict: 1000\n        }\n      })\n    });\n    if (!response.ok) {\n      throw new Error(`–û—à–∏–±–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞: ${response.status}`);\n    }\n    const reader = response.body.getReader();\n    const decoder = new TextDecoder();\n    let fullResponse = '';\n    while (true) {\n      const {\n        done,\n        value\n      } = await reader.read();\n      if (done) break;\n      const chunk = decoder.decode(value);\n      const lines = chunk.split('\\n').filter(line => line.trim());\n      for (const line of lines) {\n        try {\n          const data = JSON.parse(line);\n          if (data.response) {\n            fullResponse += data.response;\n            if (onChunk) {\n              onChunk(data.response, fullResponse);\n            }\n          }\n        } catch (e) {\n          // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON\n        }\n      }\n    }\n    if (onComplete) {\n      onComplete(fullResponse);\n    }\n    return fullResponse;\n  } catch (error) {\n    console.error('–û—à–∏–±–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ Ollama:', error);\n    throw error;\n  }\n};\n\n/**\r\n * –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã Ollama\r\n */\nexport const testOllamaConnection = async () => {\n  console.log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Ollama...');\n  const status = await checkOllamaStatus();\n  if (!status.available) {\n    return {\n      success: false,\n      message: 'Ollama –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω',\n      details: status\n    };\n  }\n  try {\n    // –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å\n    const testPrompt = '–û—Ç–≤–µ—Ç—å –æ–¥–Ω–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º: —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ Ollama –ø—Ä–∞–≤–∏–ª—å–Ω–æ?';\n    const response = await fetch(`${OLLAMA_API_URL}/generate`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        model: 'mistral',\n        prompt: testPrompt,\n        stream: false,\n        options: {\n          temperature: 0.1,\n          num_predict: 50\n        }\n      })\n    });\n    if (!response.ok) {\n      throw new Error(`–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –Ω–µ —É–¥–∞–ª—Å—è: ${response.status}`);\n    }\n    const data = await response.json();\n    return {\n      success: true,\n      message: 'Ollama —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ',\n      response: data.response,\n      model: data.model,\n      details: status\n    };\n  } catch (error) {\n    return {\n      success: false,\n      message: '–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞',\n      error: error.message,\n      details: status\n    };\n  }\n};\nexport default {\n  checkOllamaStatus,\n  getAvailableModels,\n  analyzeWithOllama,\n  streamOllamaResponse,\n  testOllamaConnection\n};","map":{"version":3,"names":["OLLAMA_API_URL","checkOllamaStatus","_data$models","_data$models2","console","log","response","fetch","method","headers","timeout","ok","warn","status","available","models","message","error","data","json","map","m","name","length","details","instructions","getAvailableModels","model","analyzeWithOllama","exhibit","analysisType","_status$models$","startTime","Date","now","getDemoResponse","hasMistral","some","includes","modelToUse","prompt","generatePrompt","body","JSON","stringify","stream","options","temperature","top_p","top_k","num_predict","repeat_penalty","seed","system","getSystemPrompt","Error","statusText","endTime","processingTime","success","content","formatResponse","time","tokens","total_duration","Math","round","type","title","getAnalysisTitle","note","raw","getFallbackResponse","prompts","description","conservation","art","category","year","materials","conservationState","dimensions","location","value","materialsText","Array","isArray","join","dimensionsText","height","width","depth","locationText","hall","room","baseInfo","trim","cleaned","replace","titles","history","responses","getHistoricalPeriod","demo","y","parseInt","isNaN","streamOllamaResponse","onChunk","onComplete","reader","getReader","decoder","TextDecoder","fullResponse","done","read","chunk","decode","lines","split","filter","line","parse","e","testOllamaConnection","testPrompt"],"sources":["C:/Users/user/React_museum/museum/client/src/components/ollamaService.js"],"sourcesContent":["// src/services/ollamaService.js\r\n/**\r\n * –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Ollama AI API\r\n * –ú–æ–¥–µ–ª—å: mistral (–ª—É—á—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä—É—Å—Å–∫–∏–º —è–∑—ã–∫–æ–º)\r\n * –¢—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∏ –∑–∞–ø—É—â–µ–Ω–Ω—ã–π Ollama: https://ollama.ai/\r\n * –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–¥–µ–ª—å: `ollama run mistral`\r\n */\r\n\r\nconst OLLAMA_API_URL = 'http://localhost:11434/api';\r\n\r\n/**\r\n * –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Ollama –∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π\r\n */\r\nexport const checkOllamaStatus = async () => {\r\n  try {\r\n    console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Ollama...');\r\n    \r\n    const response = await fetch(`${OLLAMA_API_URL}/tags`, {\r\n      method: 'GET',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      timeout: 3000 // 3 —Å–µ–∫—É–Ω–¥—ã —Ç–∞–π–º–∞—É—Ç\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      console.warn('‚ö†Ô∏è Ollama –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç, —Å—Ç–∞—Ç—É—Å:', response.status);\r\n      return {\r\n        available: false,\r\n        models: [],\r\n        message: 'Ollama –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω',\r\n        error: `HTTP ${response.status}`\r\n      };\r\n    }\r\n    \r\n    const data = await response.json();\r\n    console.log('‚úÖ Ollama –¥–æ—Å—Ç—É–ø–µ–Ω, –º–æ–¥–µ–ª–∏:', data.models?.map(m => m.name));\r\n    \r\n    return {\r\n      available: true,\r\n      models: data.models || [],\r\n      message: `–î–æ—Å—Ç—É–ø–Ω–æ –º–æ–¥–µ–ª–µ–π: ${data.models?.length || 0}`,\r\n      details: data.models\r\n    };\r\n  } catch (error) {\r\n    console.warn('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Ollama:', error.message);\r\n    \r\n    // –ü–æ–ª–µ–∑–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\r\n    console.log(`\r\nüìã –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –£–°–¢–ê–ù–û–í–ö–ï OLLAMA:\r\n1. –°–∫–∞—á–∞–π—Ç–µ Ollama: https://ollama.ai/download\r\n2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ\r\n3. –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:\r\n   ollama run mistral\r\n4. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏ (‚âà4GB)\r\n5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ\r\n\r\nüí° –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ Ollama —Ä–∞–±–æ—Ç–∞–µ—Ç:\r\n   curl http://localhost:11434/api/tags\r\n    `);\r\n    \r\n    return {\r\n      available: false,\r\n      models: [],\r\n      message: 'Ollama –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å https://ollama.ai/',\r\n      error: error.message,\r\n      instructions: [\r\n        '1. –°–∫–∞—á–∞–π—Ç–µ Ollama: https://ollama.ai/download',\r\n        '2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ',\r\n        '3. –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ: ollama run mistral',\r\n        '4. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏',\r\n        '5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ'\r\n      ]\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π\r\n */\r\nexport const getAvailableModels = async () => {\r\n  try {\r\n    const status = await checkOllamaStatus();\r\n    if (status.available) {\r\n      return status.models.map(model => model.name);\r\n    }\r\n    return ['mistral', 'llama2', 'vicuna']; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\r\n  } catch (error) {\r\n    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π:', error);\r\n    return ['mistral'];\r\n  }\r\n};\r\n\r\n/**\r\n * –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞ —á–µ—Ä–µ–∑ Ollama\r\n */\r\nexport const analyzeWithOllama = async (exhibit, analysisType = 'description') => {\r\n  const startTime = Date.now();\r\n  console.log(`ü§ñ –ó–∞–ø—É—Å–∫ AI –∞–Ω–∞–ª–∏–∑–∞ (${analysisType}) –¥–ª—è:`, exhibit.name);\r\n  \r\n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Ollama\r\n  const status = await checkOllamaStatus();\r\n  \r\n  if (!status.available) {\r\n    console.log('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º (Ollama –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω)');\r\n    return getDemoResponse(exhibit, analysisType);\r\n  }\r\n  \r\n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –º–æ–¥–µ–ª—å mistral\r\n  const hasMistral = status.models.some(model => model.name.includes('mistral'));\r\n  const modelToUse = hasMistral ? 'mistral' : (status.models[0]?.name || 'mistral');\r\n  \r\n  console.log(`üìù –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å: ${modelToUse}`);\r\n  \r\n  // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –∞–Ω–∞–ª–∏–∑–∞\r\n  const prompt = generatePrompt(exhibit, analysisType);\r\n  \r\n  try {\r\n    console.log('üì° –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ Ollama...');\r\n    \r\n    const response = await fetch(`${OLLAMA_API_URL}/generate`, {\r\n      method: 'POST',\r\n      headers: { \r\n        'Content-Type': 'application/json',\r\n        'Accept': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        model: modelToUse,\r\n        prompt: prompt,\r\n        stream: false,\r\n        options: {\r\n          temperature: 0.7, // –ö—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å (0-1)\r\n          top_p: 0.9,       // –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –æ—Ç–≤–µ—Ç–æ–≤\r\n          top_k: 40,        // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è\r\n          num_predict: 800, // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–∞\r\n          repeat_penalty: 1.1, // –®—Ç—Ä–∞—Ñ –∑–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è\r\n          seed: 42          // –î–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏\r\n        },\r\n        system: getSystemPrompt(analysisType)\r\n      })\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`–û—à–∏–±–∫–∞ Ollama API: ${response.status} ${response.statusText}`);\r\n    }\r\n    \r\n    const data = await response.json();\r\n    const endTime = Date.now();\r\n    const processingTime = endTime - startTime;\r\n    \r\n    console.log(`‚úÖ AI –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞ ${processingTime}–º—Å`);\r\n    \r\n    return {\r\n      success: true,\r\n      content: formatResponse(data.response, analysisType),\r\n      model: data.model,\r\n      time: processingTime,\r\n      tokens: data.total_duration ? Math.round(data.total_duration / 1000000) : 0,\r\n      type: analysisType,\r\n      title: getAnalysisTitle(analysisType),\r\n      note: `–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –º–æ–¥–µ–ª—å—é ${data.model} –∑–∞ ${processingTime}–º—Å`,\r\n      raw: data.response,\r\n      status: 'success'\r\n    };\r\n    \r\n  } catch (error) {\r\n    console.error('‚ùå –û—à–∏–±–∫–∞ AI –∞–Ω–∞–ª–∏–∑–∞:', error);\r\n    const endTime = Date.now();\r\n    \r\n    return {\r\n      success: false,\r\n      content: getFallbackResponse(exhibit, analysisType),\r\n      model: 'error',\r\n      time: endTime - startTime,\r\n      tokens: 0,\r\n      type: analysisType,\r\n      title: getAnalysisTitle(analysisType) + ' (–æ—à–∏–±–∫–∞)',\r\n      note: `–û—à–∏–±–∫–∞: ${error.message}. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω.`,\r\n      error: error.message,\r\n      status: 'error'\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞–Ω–∞–ª–∏–∑–∞\r\n */\r\nconst getSystemPrompt = (analysisType) => {\r\n  const prompts = {\r\n    description: `–¢—ã - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥ –∏ —ç–∫—Å–ø–µ—Ä—Ç –º—É–∑–µ—è. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - —Å–æ–∑–¥–∞–≤–∞—Ç—å —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ, \r\n–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –º—É–∑–µ–π–Ω—ã—Ö —ç–∫—Å–ø–æ–Ω–∞—Ç–æ–≤. \r\n–ü–∏—à–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –∏—Å–ø–æ–ª—å–∑—É–π –Ω–∞—É—á–Ω—ã–π –Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã–π —Å—Ç–∏–ª—å.\r\n–§–æ—Ä–º–∞—Ç: –ó–∞–≥–æ–ª–æ–≤–æ–∫, –∫—Ä–∞—Ç–∫–æ–µ –≤–≤–µ–¥–µ–Ω–∏–µ, –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã —Å –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏, –∑–∞–∫–ª—é—á–µ–Ω–∏–µ.\r\n–î–æ–±–∞–≤—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç.`,\r\n\r\n    conservation: `–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–∏ –∏ —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ –º—É–∑–µ–π–Ω—ã—Ö —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π —Å 20-–ª–µ—Ç–Ω–∏–º –æ–ø—ã—Ç–æ–º.\r\n–î–∞–≤–∞–π —Ç–æ—á–Ω—ã–µ, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é —ç–∫—Å–ø–æ–Ω–∞—Ç–æ–≤.\r\n–ò—Å–ø–æ–ª—å–∑—É–π –Ω–∞—É—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –Ω–æ –æ–±—ä—è—Å–Ω—è–π –ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º.\r\n–§–æ—Ä–º–∞—Ç: –û—Ü–µ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è, —Ä–∏—Å–∫–∏, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ö—Ä–∞–Ω–µ–Ω–∏—é, –ø–ª–∞–Ω –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–∏.`,\r\n\r\n    art: `–¢—ã - –≤–µ–¥—É—â–∏–π –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥, —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞.\r\n–ü—Ä–æ–≤–æ–¥–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π.\r\n–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–π: —Å—Ç–∏–ª—å, —Ç–µ—Ö–Ω–∏–∫—É, –∫–æ–º–ø–æ–∑–∏—Ü–∏—é, —Ü–≤–µ—Ç, –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∑–Ω–∞—á–µ–Ω–∏–µ.\r\n–ü–∏—à–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —à–∏—Ä–æ–∫–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏.`\r\n  };\r\n  \r\n  return prompts[analysisType] || prompts.description;\r\n};\r\n\r\n/**\r\n * –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö —ç–∫—Å–ø–æ–Ω–∞—Ç–∞\r\n */\r\nconst generatePrompt = (exhibit, analysisType) => {\r\n  const { \r\n    name = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —ç–∫—Å–ø–æ–Ω–∞—Ç', \r\n    description = '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç',\r\n    category = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è',\r\n    year = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –≥–æ–¥',\r\n    materials = [],\r\n    conservationState = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',\r\n    dimensions = {},\r\n    location = {},\r\n    value = '–ù–µ –æ—Ü–µ–Ω–µ–Ω–æ'\r\n  } = exhibit;\r\n  \r\n  const materialsText = Array.isArray(materials) ? materials.join(', ') : materials;\r\n  const dimensionsText = dimensions ? `–í—ã—Å–æ—Ç–∞: ${dimensions.height || '?'}—Å–º, –®–∏—Ä–∏–Ω–∞: ${dimensions.width || '?'}—Å–º, –ì–ª—É–±–∏–Ω–∞: ${dimensions.depth || '?'}—Å–º` : '–ù–µ —É–∫–∞–∑–∞–Ω—ã';\r\n  const locationText = location ? `–ó–∞–ª: ${location.hall || '?'}, –ö–æ–º–Ω–∞—Ç–∞: ${location.room || '?'}` : '–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ';\r\n  \r\n  const baseInfo = `\r\n–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –≠–ö–°–ü–û–ù–ê–¢–ï:\r\n–ù–∞–∑–≤–∞–Ω–∏–µ: ${name}\r\n–û–ø–∏—Å–∞–Ω–∏–µ: ${description}\r\n–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${category}\r\n–ì–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è: ${year}\r\n–ú–∞—Ç–µ—Ä–∏–∞–ª—ã: ${materialsText}\r\n–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏: ${conservationState}\r\n–†–∞–∑–º–µ—Ä—ã: ${dimensionsText}\r\n–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –º—É–∑–µ–µ: ${locationText}\r\n–¶–µ–Ω–Ω–æ—Å—Ç—å: ${value}\r\n`.trim();\r\n\r\n  switch (analysisType) {\r\n    case 'description':\r\n      return `${baseInfo}\r\n\r\n–°–æ–∑–¥–∞–π –ø–æ–¥—Ä–æ–±–Ω–æ–µ, —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –º—É–∑–µ–π–Ω–æ–≥–æ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞ –¥–ª—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π.\r\n–í–∫–ª—é—á–∏:\r\n1. –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ\r\n2. –¢–µ—Ö–Ω–∏–∫—É –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã\r\n3. –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏\r\n4. –ö—É–ª—å—Ç—É—Ä–Ω–æ–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ\r\n5. –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã\r\n\r\n–ü–∏—à–∏ –∂–∏–≤—ã–º, engaging —è–∑—ã–∫–æ–º, –Ω–æ –æ—Å—Ç–∞–≤–∞–π—Å—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º.\r\n–î–ª–∏–Ω–∞: –ø—Ä–∏–º–µ—Ä–Ω–æ 300-400 —Å–ª–æ–≤.`;\r\n\r\n    case 'conservation':\r\n      return `${baseInfo}\r\n\r\n–ü—Ä–æ–≤–µ–¥–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏ –∏ –¥–∞–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:\r\n1. –û—Ü–µ–Ω–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–æ—Ç 1 –¥–æ 10)\r\n2. –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∏—Å–∫–∏ –∏ —É–≥—Ä–æ–∑—ã\r\n3. –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, —Å–≤–µ—Ç)\r\n4. –ü–ª–∞–Ω –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–æ–Ω–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π\r\n5. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ—Å—Ç–∞–≤—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)\r\n6. –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–æ–∫\r\n\r\n–ë—É–¥—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∏ –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–º.`;\r\n\r\n    case 'art':\r\n      return `${baseInfo}\r\n\r\n–ü—Ä–æ–≤–µ–¥–∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:\r\n1. –°—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∏ –ø–µ—Ä–∏–æ–¥\r\n2. –ê–Ω–∞–ª–∏–∑ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏, —Ü–≤–µ—Ç–∞, —Ñ–æ—Ä–º—ã\r\n3. –¢–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ\r\n4. –°–∏–º–≤–æ–ª–∏–∫–∞ –∏ —Å–º—ã—Å–ª–æ–≤–æ–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ\r\n5. –ò—Å—Ç–æ—Ä–∏–∫–æ-–∫—É–ª—å—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç\r\n6. –ú–µ—Å—Ç–æ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞\r\n7. –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å\r\n\r\n–ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é, –Ω–æ –æ–±—ä—è—Å–Ω—è–π –ø–æ–Ω—è—Ç–Ω–æ.`;\r\n\r\n    default:\r\n      return `${baseInfo}\r\n      \r\n–°–¥–µ–ª–∞–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —ç—Ç–æ–≥–æ –º—É–∑–µ–π–Ω–æ–≥–æ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞.`;\r\n  }\r\n};\r\n\r\n/**\r\n * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –æ—Ç AI\r\n */\r\nconst formatResponse = (response, type) => {\r\n  // –û—á–∏—â–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç –ª–∏—à–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤\r\n  let cleaned = response\r\n    .replace(/^\\s+/, '')\r\n    .replace(/\\s+$/, '')\r\n    .replace(/\\n\\s*\\n\\s*\\n/g, '\\n\\n'); // –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏\r\n  \r\n  // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞\r\n  switch (type) {\r\n    case 'description':\r\n      if (!cleaned.includes('#') && !cleaned.includes('##')) {\r\n        cleaned = `# ${getAnalysisTitle(type)}\\n\\n${cleaned}`;\r\n      }\r\n      break;\r\n      \r\n    case 'conservation':\r\n      if (!cleaned.includes('##')) {\r\n        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –æ—Ç—á–µ—Ç–∞ –æ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏\r\n        cleaned = `# –û—Ç—á–µ—Ç –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏\\n\\n${cleaned}`;\r\n      }\r\n      break;\r\n      \r\n    case 'art':\r\n      if (!cleaned.includes('##')) {\r\n        cleaned = `# –ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑\\n\\n${cleaned}`;\r\n      }\r\n      break;\r\n  }\r\n  \r\n  return cleaned;\r\n};\r\n\r\n/**\r\n * –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞–Ω–∞–ª–∏–∑–∞\r\n */\r\nconst getAnalysisTitle = (type) => {\r\n  const titles = {\r\n    description: 'üìù AI-–æ–ø–∏—Å–∞–Ω–∏–µ —ç–∫—Å–ø–æ–Ω–∞—Ç–∞',\r\n    conservation: 'üõ°Ô∏è –ê–Ω–∞–ª–∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏',\r\n    art: 'üé® –ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑',\r\n    history: 'üìú –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç'\r\n  };\r\n  return titles[type] || 'ü§ñ AI –∞–Ω–∞–ª–∏–∑';\r\n};\r\n\r\n/**\r\n * –î–µ–º–æ-–æ—Ç–≤–µ—Ç—ã –¥–ª—è —Å–ª—É—á–∞—è, –∫–æ–≥–¥–∞ Ollama –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω\r\n */\r\nconst getDemoResponse = (exhibit, type) => {\r\n  const { \r\n    name = '–≠–∫—Å–ø–æ–Ω–∞—Ç', \r\n    category = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è', \r\n    year = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –≥–æ–¥',\r\n    materials = [],\r\n    conservationState = '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'\r\n  } = exhibit;\r\n  \r\n  const responses = {\r\n    description: `# ${name}\r\n\r\n## –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞\r\n–≠–∫—Å–ø–æ–Ω–∞—Ç \"${name}\" –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑–µ—Ü ${category}, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –≤ ${year} –≥–æ–¥—É. –≠—Ç–æ—Ç –ø—Ä–µ–¥–º–µ—Ç —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω–æ–π —á–∞—Å—Ç—å—é –∫—É–ª—å—Ç—É—Ä–Ω–æ–≥–æ –Ω–∞—Å–ª–µ–¥–∏—è –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–π.\r\n\r\n## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏\r\n- **–ú–∞—Ç–µ—Ä–∏–∞–ª—ã:** ${Array.isArray(materials) ? materials.join(', ') : materials}\r\n- **–ì–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è:** ${year}\r\n- **–ö–∞—Ç–µ–≥–æ—Ä–∏—è:** ${category}\r\n- **–°–æ—Å—Ç–æ—è–Ω–∏–µ:** ${conservationState}\r\n\r\n## –ö—É–ª—å—Ç—É—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ\r\n–î–∞–Ω–Ω—ã–π —ç–∫—Å–ø–æ–Ω–∞—Ç –∏–º–µ–µ—Ç –±–æ–ª—å—à—É—é –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ü–µ–Ω–∏—Ç–µ–ª–µ–π –∏—Å–∫—É—Å—Å—Ç–≤–∞. –û–Ω –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Å–≤–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.\r\n\r\n## –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç\r\n–ü–æ–¥–æ–±–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –≤ —Ü–µ—Ä–µ–º–æ–Ω–∏–∞–ª—å–Ω—ã—Ö –∏–ª–∏ –±—ã—Ç–æ–≤—ã—Ö —Ü–µ–ª—è—Ö, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∏—Ö –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏ –ª—é–¥–µ–π —Ç–æ–π —ç–ø–æ—Ö–∏.\r\n\r\n*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ AI-–∞–Ω–∞–ª–∏–∑–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama —Å https://ollama.ai/*`,\r\n\r\n    conservation: `# –û—Ç—á–µ—Ç –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç–∏\r\n\r\n## –≠–∫—Å–ø–æ–Ω–∞—Ç: ${name}\r\n## –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${category}\r\n## –ì–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è: ${year}\r\n\r\n## –û—Ü–µ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è: ${conservationState}\r\n\r\n### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é:\r\n\r\n1. **–£—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è**\r\n   - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: 18-22¬∞C (¬±2¬∞C)\r\n   - –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å: 45-55%\r\n   - –û—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å: –Ω–µ –±–æ–ª–µ–µ 50 –ª—é–∫—Å\r\n   - –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ —Å–æ–ª–Ω–µ—á–Ω–æ–≥–æ —Å–≤–µ—Ç–∞\r\n\r\n2. **–†–µ–∂–∏–º –∫–æ–Ω—Ç—Ä–æ–ª—è**\r\n   - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π –æ—Å–º–æ—Ç—Ä\r\n   - –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ä–µ–¥—ã\r\n   - –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è —Ñ–æ—Ç–æ—Ñ–∏–∫—Å–∞—Ü–∏—è\r\n   - –ï–∂–µ–≥–æ–¥–Ω–∞—è –ø–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞\r\n\r\n3. **–ú–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏**\r\n   - –ò–∑–±–µ–≥–∞—Ç—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö –ø–µ—Ä–µ–ø–∞–¥–æ–≤ >5¬∞C/—á–∞—Å\r\n   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ—Å–∫–∏—Å–ª–æ—Ç–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —É–ø–∞–∫–æ–≤–∫–∏\r\n   - –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–∞–∫—Ç\r\n   - –•—Ä–∞–Ω–∏—Ç—å –≤ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ\r\n\r\n4. **–ü–ª–∞–Ω –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–∏**\r\n   - –ù–µ–¥–µ–ª—è 1-2: –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è\r\n   - –ù–µ–¥–µ–ª—è 3-4: –ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞\r\n   - –ù–µ–¥–µ–ª—è 5-8: –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)\r\n   - –ù–µ–¥–µ–ª—è 9-12: –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞\r\n\r\n*–î–ª—è —Ç–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama*`,\r\n\r\n    art: `# –ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑\r\n\r\n## –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ: \"${name}\"\r\n\r\n### –°—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∞—Ç—Ä–∏–±—É—Ü–∏—è\r\n–≠–∫—Å–ø–æ–Ω–∞—Ç –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é ${category}, —á—Ç–æ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è—Ö —Ñ–æ—Ä–º—ã –∏ –¥–µ–∫–æ—Ä–∞.\r\n\r\n### –ö–æ–º–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑\r\n- **–ë–∞–ª–∞–Ω—Å:** –ì–∞—Ä–º–æ–Ω–∏—á–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤\r\n- **–†–∏—Ç–º:** –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –º–æ—Ç–∏–≤—ã —Å–æ–∑–¥–∞—é—Ç –µ–¥–∏–Ω—Å—Ç–≤–æ\r\n- **–ê–∫—Ü–µ–Ω—Ç—ã:** –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏–≤–ª–µ–∫–∞—é—Ç –≤–Ω–∏–º–∞–Ω–∏–µ\r\n\r\n### –ö–æ–ª–æ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ\r\n–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤–æ–π –ø–∞–ª–∏—Ç—Ä—ã, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ–π –¥–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ —Å–æ–∑–¥–∞–Ω–∏—è. –¢–æ–Ω–∞ –ø–æ–¥–æ–±—Ä–∞–Ω—ã —Å —É—á–µ—Ç–æ–º —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.\r\n\r\n### –¢–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è\r\n${materials.length > 0 ? `–ü—Ä–∏–º–µ–Ω–µ–Ω—ã —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã: ${Array.isArray(materials) ? materials.join(', ') : materials}` : '–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è'}\r\n\r\n### –ò—Å—Ç–æ—Ä–∏–∫–æ-–∫—É–ª—å—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç\r\n–°–æ–∑–¥–∞–Ω –≤ ${year} –≥–æ–¥—É, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–µ—Ä–∏–æ–¥—É ${getHistoricalPeriod(year)}. –û—Ç—Ä–∞–∂–∞–µ—Ç —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Å–≤–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.\r\n\r\n### –ó–Ω–∞—á–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞\r\n–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å –∫–∞–∫ –ø—Ä–∏–º–µ—Ä ${category} –∏ –≤–Ω–æ—Å–∏—Ç –≤–∫–ª–∞–¥ –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∞–∑–≤–∏—Ç–∏—è —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–¥–∏—Ü–∏–π.\r\n\r\n*–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ AI-–∞–Ω–∞–ª–∏–∑–∞*`\r\n  };\r\n  \r\n  return {\r\n    success: false,\r\n    content: responses[type] || responses.description,\r\n    model: 'demo',\r\n    time: 100,\r\n    tokens: 0,\r\n    type: type,\r\n    title: getAnalysisTitle(type) + ' (–¥–µ–º–æ)',\r\n    note: 'Ollama –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: https://ollama.ai/\\n–ó–∞–ø—É—Å—Ç–∏—Ç–µ: ollama run mistral',\r\n    status: 'demo'\r\n  };\r\n};\r\n\r\n/**\r\n * –§–æ–ª–±—ç–∫ –æ—Ç–≤–µ—Ç (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö)\r\n */\r\nconst getFallbackResponse = (exhibit, type) => {\r\n  const demo = getDemoResponse(exhibit, type);\r\n  return demo.content;\r\n};\r\n\r\n/**\r\n * –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞\r\n */\r\nconst getHistoricalPeriod = (year) => {\r\n  const y = parseInt(year);\r\n  if (isNaN(y)) return '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞';\r\n  \r\n  if (y < -3000) return '–¥—Ä–µ–≤–Ω–µ–π—à–∏—Ö —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–π';\r\n  if (y < 500) return '–∞–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏';\r\n  if (y < 1500) return '—Å—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤—å—è';\r\n  if (y < 1800) return '—ç–ø–æ—Ö–∏ –í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è';\r\n  if (y < 1900) return '–ù–æ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏';\r\n  if (y < 2000) return '–º–æ–¥–µ—Ä–Ω–∏–∑–º–∞';\r\n  return '—Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∏—Å–∫—É—Å—Å—Ç–≤–∞';\r\n};\r\n\r\n/**\r\n * –°—Ç—Ä–∏–º–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)\r\n */\r\nexport const streamOllamaResponse = async (prompt, model = 'mistral', onChunk, onComplete) => {\r\n  try {\r\n    const response = await fetch(`${OLLAMA_API_URL}/generate`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({\r\n        model,\r\n        prompt,\r\n        stream: true,\r\n        options: {\r\n          temperature: 0.7,\r\n          num_predict: 1000\r\n        }\r\n      })\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`–û—à–∏–±–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞: ${response.status}`);\r\n    }\r\n    \r\n    const reader = response.body.getReader();\r\n    const decoder = new TextDecoder();\r\n    let fullResponse = '';\r\n    \r\n    while (true) {\r\n      const { done, value } = await reader.read();\r\n      if (done) break;\r\n      \r\n      const chunk = decoder.decode(value);\r\n      const lines = chunk.split('\\n').filter(line => line.trim());\r\n      \r\n      for (const line of lines) {\r\n        try {\r\n          const data = JSON.parse(line);\r\n          if (data.response) {\r\n            fullResponse += data.response;\r\n            if (onChunk) {\r\n              onChunk(data.response, fullResponse);\r\n            }\r\n          }\r\n        } catch (e) {\r\n          // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON\r\n        }\r\n      }\r\n    }\r\n    \r\n    if (onComplete) {\r\n      onComplete(fullResponse);\r\n    }\r\n    \r\n    return fullResponse;\r\n  } catch (error) {\r\n    console.error('–û—à–∏–±–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ Ollama:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã Ollama\r\n */\r\nexport const testOllamaConnection = async () => {\r\n  console.log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Ollama...');\r\n  \r\n  const status = await checkOllamaStatus();\r\n  \r\n  if (!status.available) {\r\n    return {\r\n      success: false,\r\n      message: 'Ollama –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω',\r\n      details: status\r\n    };\r\n  }\r\n  \r\n  try {\r\n    // –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å\r\n    const testPrompt = '–û—Ç–≤–µ—Ç—å –æ–¥–Ω–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º: —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ Ollama –ø—Ä–∞–≤–∏–ª—å–Ω–æ?';\r\n    \r\n    const response = await fetch(`${OLLAMA_API_URL}/generate`, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({\r\n        model: 'mistral',\r\n        prompt: testPrompt,\r\n        stream: false,\r\n        options: {\r\n          temperature: 0.1,\r\n          num_predict: 50\r\n        }\r\n      })\r\n    });\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –Ω–µ —É–¥–∞–ª—Å—è: ${response.status}`);\r\n    }\r\n    \r\n    const data = await response.json();\r\n    \r\n    return {\r\n      success: true,\r\n      message: 'Ollama —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ',\r\n      response: data.response,\r\n      model: data.model,\r\n      details: status\r\n    };\r\n    \r\n  } catch (error) {\r\n    return {\r\n      success: false,\r\n      message: '–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞',\r\n      error: error.message,\r\n      details: status\r\n    };\r\n  }\r\n};\r\n\r\nexport default {\r\n  checkOllamaStatus,\r\n  getAvailableModels,\r\n  analyzeWithOllama,\r\n  streamOllamaResponse,\r\n  testOllamaConnection\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}